clc;
clear all;

% *** start part (a) ***
syms t w tau;

A = [0 1 0 0; ...
	3*w^2 0 0 2*w; ...
	0 0 0 1; ...
	0 -2*w 0 0];

% STM = simplify(expm(A*(t-tau)))
STM = [                              4 - sin(w*(t - tau))*3i,                                   sin(w*(t - tau))/w, 0, -(exp(-w*(t - tau)*1i)*(exp(w*(t - tau)*1i) - 1)^2)/w; ...
	                                3*w*sin(w*(t - tau)),                                     cos(w*(t - tau)), 0,                                    2*sin(w*(t - tau)); ...
	                   6*sin(w*(t - tau)) - 6*w*(t + tau), (exp(-w*(t - tau)*1i)*(exp(w*(t - tau)*1i) - 1)^2)/w, 1,                (4*sin(w*(t - tau)) - 3*w*(t + tau))/w; ...
	 3*w*exp(-w*(t - tau)*1i)*(exp(w*(t - tau)*1i) - 1)^2,                                  -2*sin(w*(t - tau)), 0,                                4*cos(w*(t - tau)) - 3]


C = [1 0 0 0; ...
	0 0 0 0; ...
	0 0 1 0; ...
	0 0 0 0];
C = [1,0,1,0];

B = [0 0; ...
	1 0; ...
	0 0; ...
	0 1];

syms s;

transferFunction = C * inv(s*eye(4) - A) * B

% *** start part (b) ***
% period T is ts
syms ts;
Ad = simplify(expm(A*ts))

syms sigma;
Bd = int(simplify(expm(A * sigma)), sigma, [0 ts]) * B

% x = -5:1e-3:45;
% eigs = eig(Ad);
% y = eigs(4,1);
% y = subs(y, ts, .01);
% y = subs(y, w, x);
% plot(x,y);

% shows eigenvalues never reach 0
% syms sol;
% solve(cosh(3^(1/2)*.01*sol) - sinh(3^(1/2)*.01*sol)==0,sol)
% solve(cosh(3^(1/2)*.01*sol) + sinh(3^(1/2)*.01*sol)==0,sol)

% *** start part (c) ***
% since sys is LTI, analyzing eigenvalues for US/UES
% BIBO stability addressed entirely in maple, using results from part d
% for the rest of this part, look to Maple files

% *** start part (d) ***
% controllability and observability are fully addressed in respective maple files
% work with controllability Gramian remains for use with controller in part e

syms t0 tf;
modSTM = subs(STM, t, t0);
modSTM = subs(modSTM, tau, sigma);
W = simplify(int(modSTM * B * transpose(B) * transpose(modSTM), sigma, [t0 tf]))
%{
W = [                                                 -((3*sin(2*w*(t0 - tf)))/4 - 8*sin(w*(t0 - tf)) + w*((13*t0)/2 - (13*tf)/2))/w^3,                                                                      -(sin(w*(t0 - tf))^2 + 16*sin((w*(t0 - tf))/2)^4)/(2*w^2),                                                     (3*t0^2*w^2 - (3*cos(2*w*(t0 - tf)))/2 + 3*tf^2*w^2 - 6*t0*tf*w^2 - 6*t0*w*sin(w*(t0 - tf)) + 6*tf*w*sin(w*(t0 - tf)) + 3/2)/w^3,                                                                               -(14*sin(w*(t0 - tf)) - (3*sin(2*w*(t0 - tf)))/2 - 11*t0*w + 11*tf*w)/w^2; ...
	                                                                        -(sin(w*(t0 - tf))^2 + 16*sin((w*(t0 - tf))/2)^4)/(2*w^2),                                                                             (5*tf)/2 - (5*t0)/2 + (3*sin(2*w*(t0 - tf)))/(4*w),                                                       (16*sin(w*(t0 - tf)) + 3*sin(2*w*(t0 - tf)) - 10*t0*w + 10*tf*w - 12*t0*w*cos(w*(t0 - tf)) + 12*tf*w*cos(w*(t0 - tf)))/(2*w^2),                                                                                                 ((3*cos(2*w*(t0 - tf)))/2 - 6*cos(w*(t0 - tf)) + 9/2)/w; ...
	 (3*t0^2*w^2 - (3*cos(2*w*(t0 - tf)))/2 + 3*tf^2*w^2 - 6*t0*tf*w^2 - 6*t0*w*sin(w*(t0 - tf)) + 6*tf*w*sin(w*(t0 - tf)) + 3/2)/w^3, (16*sin(w*(t0 - tf)) + 3*sin(2*w*(t0 - tf)) - 10*t0*w + 10*tf*w - 12*t0*w*cos(w*(t0 - tf)) + 12*tf*w*cos(w*(t0 - tf)))/(2*w^2), (32*sin(w*(t0 - tf)) + 3*sin(2*w*(t0 - tf)) - 3*t0^3*w^3 + 3*tf^3*w^3 - 14*t0*w + 14*tf*w - 24*t0*w*cos(w*(t0 - tf)) + 24*tf*w*cos(w*(t0 - tf)) - 9*t0*tf^2*w^3 + 9*t0^2*tf*w^3)/w^3, (8*cos(w*(t0 - tf)) + 6*cos(2*w*(t0 - tf)) - 9*t0^2*w^2 - 9*tf^2*w^2 + 18*t0*tf*w^2 + 24*t0*w*sin(w*(t0 - tf)) - 24*tf*w*sin(w*(t0 - tf)) - 14)/(2*w^2); ...
	                                                        -(14*sin(w*(t0 - tf)) - (3*sin(2*w*(t0 - tf)))/2 - 11*t0*w + 11*tf*w)/w^2,                                                                        ((3*cos(2*w*(t0 - tf)))/2 - 6*cos(w*(t0 - tf)) + 9/2)/w,                              (8*cos(w*(t0 - tf)) + 6*cos(2*w*(t0 - tf)) - 9*t0^2*w^2 - 9*tf^2*w^2 + 18*t0*tf*w^2 + 24*t0*w*sin(w*(t0 - tf)) - 24*tf*w*sin(w*(t0 - tf)) - 14)/(2*w^2),                                                                                          19*tf - 19*t0 + (24*sin(w*(t0 - tf)) - 3*sin(2*w*(t0 - tf)))/w]
%}
%{
deterW = det(W);
ww = 1:10;
tt0 = 0;
ttf = 0:10;
deterW = subs(deter, w, ww);
deterW = subs(deter, t0, tt0);
deterW = subs(deter, tf, ttf);

% deterW = (- 7776*cos(w*(t0 - tf)) - 3888*cos(2*w*(t0 - tf)) - 1872*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 + 144*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf))^2 + 2597376*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 393216*sin(w*(t0 - tf))^4*sin((w*(t0 - tf))/2)^4 - 29952*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 3145728*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^8 + 36864*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^8 - 210632*t0^2*w^2 + 3592*t0^4*w^4 + 300*t0^6*w^6 - 210632*tf^2*w^2 + 3592*tf^4*w^4 + 300*tf^6*w^6 + 12960*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) + 5184*cos(w*(t0 - tf))^2 - 648*cos(2*w*(t0 - tf))^2 + 1296*cos(2*w*(t0 - tf))^3 + 324*cos(2*w*(t0 - tf))^4 - 23712*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 496080*sin(w*(t0 - tf))^2 + 177936*sin(w*(t0 - tf))^4 + 6084*sin(2*w*(t0 - tf))^2 - 12288*sin(w*(t0 - tf))^6 - 48384*sin((w*(t0 - tf))/2)^4 + 200704*sin((w*(t0 - tf))/2)^8 - 2592*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2 - 10368*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf)) - 2592*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^3 + 1252992*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 - 201600*cos(w*(t0 - tf))*sin(w*(t0 - tf))^4 - 14976*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))^2 - 257808*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 39264*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^4 + 2808*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))^2 + 92160*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 52992*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 229376*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 172032*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 1152*sin(w*(t0 - tf))^3*sin(2*w*(t0 - tf)) + 384*sin(w*(t0 - tf))^5*sin(2*w*(t0 - tf)) + 5184*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf))^2 - 788736*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^2 + 256*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^4 + 9216*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 - 32112*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^2 - 432*cos(2*w*(t0 - tf))^3*sin(w*(t0 - tf))^2 + 144*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^4 + 324*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 - 36864*cos(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 2304*cos(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 6912*cos(2*w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 + 65536*cos(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^8 + 36864*cos(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^8 + 421264*t0*tf*w^2 + 49152*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 1728*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 650144*t0*w*sin(w*(t0 - tf)) + 32412*t0*w*sin(2*w*(t0 - tf)) - 650144*tf*w*sin(w*(t0 - tf)) - 32412*tf*w*sin(2*w*(t0 - tf)) + 8192*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 4608*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 457216*t0^2*w^2*cos(w*(t0 - tf))^2 - 479232*t0^2*w^2*cos(w*(t0 - tf))^3 - 17064*t0^2*w^2*cos(2*w*(t0 - tf))^2 - 1296*t0^2*w^2*cos(2*w*(t0 - tf))^3 - 47232*t0^4*w^4*cos(w*(t0 - tf))^2 - 1512*t0^4*w^4*cos(2*w*(t0 - tf))^2 + 457216*tf^2*w^2*cos(w*(t0 - tf))^2 - 479232*tf^2*w^2*cos(w*(t0 - tf))^3 - 17064*tf^2*w^2*cos(2*w*(t0 - tf))^2 - 1296*tf^2*w^2*cos(2*w*(t0 - tf))^3 - 47232*tf^4*w^4*cos(w*(t0 - tf))^2 - 1512*tf^4*w^4*cos(2*w*(t0 - tf))^2 + 4608*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 8168*t0^2*w^2*sin(w*(t0 - tf))^2 - 11696*t0^2*w^2*sin(w*(t0 - tf))^4 - 1548*t0^2*w^2*sin(2*w*(t0 - tf))^2 + 7008*t0^3*w^3*sin(w*(t0 - tf))^3 + 2304*t0^2*w^2*sin(w*(t0 - tf))^6 + 1296*t0^4*w^4*sin(w*(t0 - tf))^2 + 830080*t0^2*w^2*sin((w*(t0 - tf))/2)^4 - 576*t0^3*w^3*sin(w*(t0 - tf))^5 - 588*t0^4*w^4*sin(w*(t0 - tf))^4 - 27*t0^4*w^4*sin(2*w*(t0 - tf))^2 - 831488*t0^2*w^2*sin((w*(t0 - tf))/2)^8 + 51456*t0^4*w^4*sin((w*(t0 - tf))/2)^4 - 150528*t0^4*w^4*sin((w*(t0 - tf))/2)^8 + 8168*tf^2*w^2*sin(w*(t0 - tf))^2 - 11696*tf^2*w^2*sin(w*(t0 - tf))^4 - 1548*tf^2*w^2*sin(2*w*(t0 - tf))^2 - 7008*tf^3*w^3*sin(w*(t0 - tf))^3 + 2304*tf^2*w^2*sin(w*(t0 - tf))^6 + 1296*tf^4*w^4*sin(w*(t0 - tf))^2 + 830080*tf^2*w^2*sin((w*(t0 - tf))/2)^4 + 576*tf^3*w^3*sin(w*(t0 - tf))^5 - 588*tf^4*w^4*sin(w*(t0 - tf))^4 - 27*tf^4*w^4*sin(2*w*(t0 - tf))^2 - 831488*tf^2*w^2*sin((w*(t0 - tf))/2)^8 + 51456*tf^4*w^4*sin((w*(t0 - tf))/2)^4 - 150528*tf^4*w^4*sin((w*(t0 - tf))/2)^8 + 318720*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 384*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^4 - 3456*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))^2 - 110592*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 98304*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 14368*t0*tf^3*w^4 - 14368*t0^3*tf*w^4 - 1800*t0*tf^5*w^6 - 1800*t0^5*tf*w^6 - 24576*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 864*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 1152*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3*sin(2*w*(t0 - tf)) + 18432*sin(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 98304*sin(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 129920*t0*w*sin(w*(t0 - tf))^3 + 128*t0*w*sin(w*(t0 - tf))^5 + 129920*tf*w*sin(w*(t0 - tf))^3 - 128*tf*w*sin(w*(t0 - tf))^5 + 1152*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^2 + 2304*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 18432*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 36864*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 21552*t0^2*tf^2*w^4 + 4500*t0^2*tf^4*w^6 - 6000*t0^3*tf^3*w^6 + 4500*t0^4*tf^2*w^6 + 2304*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 - 432*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 - 3239936*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 36864*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 617472*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 6912*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 204352*t0^2*w^2*cos(w*(t0 - tf)) - 97152*t0^2*w^2*cos(2*w*(t0 - tf)) + 30048*t0^4*w^4*cos(w*(t0 - tf)) - 5472*t0^4*w^4*cos(2*w*(t0 - tf)) + 204352*tf^2*w^2*cos(w*(t0 - tf)) - 97152*tf^2*w^2*cos(2*w*(t0 - tf)) + 30048*tf^4*w^4*cos(w*(t0 - tf)) - 5472*tf^4*w^4*cos(2*w*(t0 - tf)) + 12288*sin(w*(t0 - tf))^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 6432*t0^3*w^3*sin(w*(t0 - tf)) - 2916*t0^3*w^3*sin(2*w*(t0 - tf)) + 6432*tf^3*w^3*sin(w*(t0 - tf)) + 2916*tf^3*w^3*sin(2*w*(t0 - tf)) - 1243264*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf)) - 107808*t0*w*cos(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 336096*t0*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) + 9288*t0*w*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) + 1243264*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf)) + 107808*tf*w*cos(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 336096*tf*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) - 9288*tf*w*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 283392*t0^2*tf^2*w^4*cos(w*(t0 - tf))^2 - 9072*t0^2*tf^2*w^4*cos(2*w*(t0 - tf))^2 - 8640*t0^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2 + 175104*t0^2*w^2*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf)) - 8640*tf^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2 + 175104*tf^2*w^2*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf)) + 7776*t0^2*tf^2*w^4*sin(w*(t0 - tf))^2 - 3528*t0^2*tf^2*w^4*sin(w*(t0 - tf))^4 - 162*t0^2*tf^2*w^4*sin(2*w*(t0 - tf))^2 + 308736*t0^2*tf^2*w^4*sin((w*(t0 - tf))/2)^4 - 903168*t0^2*tf^2*w^4*sin((w*(t0 - tf))/2)^8 - 32032*t0^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 28992*t0^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^4 + 1728*t0^2*w^2*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))^2 + 25584*t0^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 - 55296*t0^3*w^3*cos(w*(t0 - tf))^2*sin(w*(t0 - tf)) - 11520*t0^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3 - 7344*t0^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^4 - 324*t0^2*w^2*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))^2 - 12096*t0^3*w^3*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 1728*t0^3*w^3*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) - 10368*t0^4*w^4*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 568832*t0^2*w^2*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 2016*t0^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 - 324*t0^3*w^3*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 1872*t0^4*w^4*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 243456*t0^2*w^2*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 2015232*t0^2*w^2*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 165888*t0^4*w^4*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 110592*t0^2*w^2*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 29952*t0^4*w^4*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 32032*tf^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 28992*tf^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^4 + 1728*tf^2*w^2*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))^2 + 25584*tf^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 55296*tf^3*w^3*cos(w*(t0 - tf))^2*sin(w*(t0 - tf)) + 11520*tf^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3 - 7344*tf^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^4 - 324*tf^2*w^2*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))^2 + 12096*tf^3*w^3*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 1728*tf^3*w^3*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) - 10368*tf^4*w^4*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 568832*tf^2*w^2*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 2016*tf^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 + 324*tf^3*w^3*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 1872*tf^4*w^4*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 243456*tf^2*w^2*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 2015232*tf^2*w^2*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 165888*tf^4*w^4*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 110592*tf^2*w^2*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 29952*tf^4*w^4*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 2016*t0^2*w^2*sin(w*(t0 - tf))^3*sin(2*w*(t0 - tf)) + 1872*t0^3*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 144*t0^3*w^3*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) + 112128*t0^3*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 20736*t0^3*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 147456*t0^3*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 36864*t0^3*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 2016*tf^2*w^2*sin(w*(t0 - tf))^3*sin(2*w*(t0 - tf)) - 1872*tf^3*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 144*tf^3*w^3*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) - 112128*tf^3*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 20736*tf^3*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 147456*tf^3*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 36864*tf^3*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 914432*t0*tf*w^2*cos(w*(t0 - tf))^2 + 958464*t0*tf*w^2*cos(w*(t0 - tf))^3 + 34128*t0*tf*w^2*cos(2*w*(t0 - tf))^2 + 2592*t0*tf*w^2*cos(2*w*(t0 - tf))^3 - 120192*t0*tf^3*w^4*cos(w*(t0 - tf)) - 120192*t0^3*tf*w^4*cos(w*(t0 - tf)) + 21888*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 21888*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 16336*t0*tf*w^2*sin(w*(t0 - tf))^2 - 19296*t0*tf^2*w^3*sin(w*(t0 - tf)) + 19296*t0^2*tf*w^3*sin(w*(t0 - tf)) + 23392*t0*tf*w^2*sin(w*(t0 - tf))^4 + 3096*t0*tf*w^2*sin(2*w*(t0 - tf))^2 - 8748*t0*tf^2*w^3*sin(2*w*(t0 - tf)) + 8748*t0^2*tf*w^3*sin(2*w*(t0 - tf)) - 4608*t0*tf*w^2*sin(w*(t0 - tf))^6 - 1660160*t0*tf*w^2*sin((w*(t0 - tf))/2)^4 + 1662976*t0*tf*w^2*sin((w*(t0 - tf))/2)^8 - 18432*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 63488*t0*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf)) + 2048*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3 + 589824*t0*w*cos(w*(t0 - tf))^3*sin(w*(t0 - tf)) + 128640*t0*w*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 51552*t0*w*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) + 10752*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^5 - 34560*t0*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 - 55296*t0*w*cos(w*(t0 - tf))^3*sin(2*w*(t0 - tf)) + 2592*t0*w*cos(2*w*(t0 - tf))^3*sin(w*(t0 - tf)) + 540*t0*w*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 1152*t0*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^5 - 63488*tf*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf)) - 2048*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3 - 589824*tf*w*cos(w*(t0 - tf))^3*sin(w*(t0 - tf)) - 128640*tf*w*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 51552*tf*w*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) - 10752*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^5 + 34560*tf*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 + 55296*tf*w*cos(w*(t0 - tf))^3*sin(2*w*(t0 - tf)) - 2592*tf*w*cos(2*w*(t0 - tf))^3*sin(w*(t0 - tf)) - 540*tf*w*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 1152*tf*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^5 + 6480*t0*w*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 2064*t0*w*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) - 2963456*t0*w*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 99072*t0*w*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 3178496*t0*w*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 61440*t0*w*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 6480*tf*w*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 2064*tf*w*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) + 2963456*tf*w*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 99072*tf*w*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 3178496*tf*w*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 61440*tf*w*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 24576*t0^2*w^2*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^2 + 6696*t0^2*w^2*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^2 - 1966080*t0^2*w^2*cos(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 24192*t0^2*w^2*cos(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 24576*tf^2*w^2*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^2 + 6696*tf^2*w^2*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^2 - 1966080*tf^2*w^2*cos(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 24192*tf^2*w^2*cos(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 216*t0^2*w^2*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 - 239104*t0^2*w^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 73728*t0^2*w^2*sin(w*(t0 - tf))^4*sin((w*(t0 - tf))/2)^4 + 3456*t0^2*w^2*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 18432*t0^3*w^3*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 + 589824*t0^2*w^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^8 - 18816*t0^4*w^4*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 216*tf^2*w^2*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 - 239104*tf^2*w^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 73728*tf^2*w^2*sin(w*(t0 - tf))^4*sin((w*(t0 - tf))/2)^4 + 3456*tf^2*w^2*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 18432*tf^3*w^3*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 + 589824*tf^2*w^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^8 - 18816*tf^4*w^4*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 180288*t0^2*tf^2*w^4*cos(w*(t0 - tf)) + 188928*t0*tf^3*w^4*cos(w*(t0 - tf))^2 + 188928*t0^3*tf*w^4*cos(w*(t0 - tf))^2 - 32832*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 6048*t0*tf^3*w^4*cos(2*w*(t0 - tf))^2 + 6048*t0^3*tf*w^4*cos(2*w*(t0 - tf))^2 + 12288*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 22656*t0^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) + 16416*t0^4*w^4*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) - 22656*tf^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) + 16416*tf^4*w^4*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) + 21024*t0*tf^2*w^3*sin(w*(t0 - tf))^3 - 21024*t0^2*tf*w^3*sin(w*(t0 - tf))^3 - 5184*t0*tf^3*w^4*sin(w*(t0 - tf))^2 - 5184*t0^3*tf*w^4*sin(w*(t0 - tf))^2 - 1728*t0*tf^2*w^3*sin(w*(t0 - tf))^5 + 1728*t0^2*tf*w^3*sin(w*(t0 - tf))^5 + 2352*t0*tf^3*w^4*sin(w*(t0 - tf))^4 + 108*t0*tf^3*w^4*sin(2*w*(t0 - tf))^2 + 2352*t0^3*tf*w^4*sin(w*(t0 - tf))^4 + 108*t0^3*tf*w^4*sin(2*w*(t0 - tf))^2 - 205824*t0*tf^3*w^4*sin((w*(t0 - tf))/2)^4 - 205824*t0^3*tf*w^4*sin((w*(t0 - tf))/2)^4 + 602112*t0*tf^3*w^4*sin((w*(t0 - tf))/2)^8 + 602112*t0^3*tf*w^4*sin((w*(t0 - tf))/2)^8 + 159744*t0*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^3 + 69888*t0^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf)) - 3456*t0*w*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^3 + 11664*t0^3*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 11808*t0^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) - 1944*t0^3*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 159744*tf*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^3 - 69888*tf^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf)) + 3456*tf*w*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^3 - 11664*tf^3*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 11808*tf^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) + 1944*tf^3*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 13104*t0^2*w^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 200704*t0*w*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 - 13104*tf^2*w^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 200704*tf*w*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 - 408704*t0*tf*w^2*cos(w*(t0 - tf)) + 194304*t0*tf*w^2*cos(2*w*(t0 - tf)) + 26208*t0*tf*w^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 62208*t0^2*tf^2*w^4*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 11232*t0^2*tf^2*w^4*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 - 995328*t0^2*tf^2*w^4*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 179712*t0^2*tf^2*w^4*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 36576*t0^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 299520*t0^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 36576*tf^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 299520*tf^2*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 55296*t0*tf^2*w^3*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 + 55296*t0^2*tf*w^3*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 + 75264*t0*tf^3*w^4*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 75264*t0^3*tf*w^4*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 2592*t0^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 432*t0^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 184320*t0^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 41472*t0^3*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 32256*t0^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 6912*t0^3*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 2592*tf^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 432*tf^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 184320*tf^3*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 41472*tf^3*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 32256*tf^3*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 6912*tf^3*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 32256*t0^2*w^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 32256*tf^2*w^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 17280*t0*tf*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2 - 350208*t0*tf*w^2*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf)) - 65664*t0*tf^3*w^4*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) - 65664*t0^3*tf*w^4*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) + 64064*t0*tf*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 209664*t0*tf^2*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf)) - 209664*t0^2*tf*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf)) - 57984*t0*tf*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^4 - 3456*t0*tf*w^2*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))^2 - 51168*t0*tf*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 34992*t0*tf^2*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 35424*t0*tf^2*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) - 34992*t0^2*tf*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 35424*t0^2*tf*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) + 14688*t0*tf*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^4 + 648*t0*tf*w^2*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))^2 - 1137664*t0*tf*w^2*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 5832*t0*tf^2*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) + 5832*t0^2*tf*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 486912*t0*tf*w^2*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 4030464*t0*tf*w^2*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 221184*t0*tf*w^2*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 3456*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) - 202752*t0*w*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) - 18432*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 - 2592*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 24192*t0*w*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 3456*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) + 202752*tf*w*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) + 18432*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 + 2592*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 24192*tf*w*cos(w*(t0 - tf))^2*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 4032*t0*tf*w^2*sin(w*(t0 - tf))^3*sin(2*w*(t0 - tf)) + 1152*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 1152*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) + 2736*t0*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 1605632*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 313344*t0*w*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 847872*t0*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 2752512*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 11520*t0*w*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 294912*t0*w*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 294912*t0*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 1152*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 1152*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) - 2736*tf*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 1605632*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 313344*tf*w*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 847872*tf*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 2752512*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 11520*tf*w*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 294912*tf*w*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 294912*tf*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 112896*t0^2*tf^2*w^4*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 337920*t0^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 124416*t0^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 337920*tf^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 124416*tf^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 4608*t0^3*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 4608*tf^3*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 98496*t0^2*tf^2*w^4*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) - 49152*t0*tf*w^2*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^2 - 165888*t0*tf^2*w^3*cos(w*(t0 - tf))^2*sin(w*(t0 - tf)) + 165888*t0^2*tf*w^3*cos(w*(t0 - tf))^2*sin(w*(t0 - tf)) - 13392*t0*tf*w^2*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))^2 - 34560*t0*tf^2*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3 + 34560*t0^2*tf*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3 - 36288*t0*tf^2*w^3*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 5184*t0*tf^2*w^3*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) + 41472*t0*tf^3*w^4*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 36288*t0^2*tf*w^3*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 5184*t0^2*tf*w^3*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf)) + 41472*t0^3*tf*w^4*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2 + 6048*t0*tf^2*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 - 6048*t0^2*tf*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3 + 3932160*t0*tf*w^2*cos(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 972*t0*tf^2*w^3*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 7488*t0*tf^3*w^4*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 972*t0^2*tf*w^3*cos(2*w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 7488*t0^3*tf*w^4*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 - 48384*t0*tf*w^2*cos(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 663552*t0*tf^3*w^4*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 663552*t0^3*tf*w^4*cos(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 119808*t0*tf^3*w^4*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 119808*t0^3*tf*w^4*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 20736*t0^3*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) + 3888*t0^3*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 20736*tf^3*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) - 3888*tf^3*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 432*t0*tf*w^2*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))^2 + 5616*t0*tf^2*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 5616*t0^2*tf*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 478208*t0*tf*w^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 432*t0*tf^2*w^3*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) + 432*t0^2*tf*w^3*sin(w*(t0 - tf))^4*sin(2*w*(t0 - tf)) + 336384*t0*tf^2*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 336384*t0^2*tf*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 147456*t0*tf*w^2*sin(w*(t0 - tf))^4*sin((w*(t0 - tf))/2)^4 - 6912*t0*tf*w^2*sin(2*w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 62208*t0*tf^2*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 62208*t0^2*tf*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 1179648*t0*tf*w^2*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^8 - 442368*t0*tf^2*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 442368*t0^2*tf*w^3*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 110592*t0*tf^2*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 + 110592*t0^2*tf*w^3*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^8 - 16128*t0*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 20736*t0^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 3024*t0^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 2555904*t0*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 344064*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 - 258048*t0*w*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 55296*t0*w*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 36864*t0*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 + 16128*tf*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 20736*tf^2*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 3024*tf^2*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) - 2555904*tf*w*cos(w*(t0 - tf))^2*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 344064*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 + 258048*tf*w*cos(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 55296*tf*w*cos(2*w*(t0 - tf))^2*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 36864*tf*w*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^3*sin((w*(t0 - tf))/2)^4 - 29184*t0*w*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 29184*tf*w*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 45312*t0*tf*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf)) - 251136*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) - 29376*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) + 251136*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) + 29376*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 13824*t0*tf^2*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 13824*t0^2*tf*w^3*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 73152*t0*tf*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2 + 62208*t0*tf^2*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) - 62208*t0^2*tf*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf)) + 11664*t0*tf^2*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 11664*t0^2*tf*w^3*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf)) - 599040*t0*tf*w^2*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 3456*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 294912*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 55296*t0*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 3456*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 294912*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 55296*tf*w*cos(w*(t0 - tf))*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 64512*t0*tf*w^2*sin(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 7776*t0*tf^2*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) + 7776*t0^2*tf*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 675840*t0*tf*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 + 1296*t0*tf^2*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 1296*t0^2*tf*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf)) - 552960*t0*tf^2*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 552960*t0^2*tf*w^3*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 248832*t0*tf*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))^2*sin((w*(t0 - tf))/2)^4 - 124416*t0*tf^2*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 96768*t0*tf^2*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 124416*t0^2*tf*w^3*cos(w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 96768*t0^2*tf*w^3*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 20736*t0*tf^2*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 20736*t0^2*tf*w^3*cos(2*w*(t0 - tf))*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 36864*t0*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 + 36864*tf*w*cos(w*(t0 - tf))*sin(w*(t0 - tf))^2*sin(2*w*(t0 - tf))*sin((w*(t0 - tf))/2)^4 - 41472*t0*tf*w^2*cos(w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 6048*t0*tf*w^2*cos(2*w*(t0 - tf))*sin(w*(t0 - tf))*sin(2*w*(t0 - tf)) + 2916)/(64*w^8);
deterW = -(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152)/(32*w^8)
% if W is nonsingular, sys is controllable
%}
%{
modSTM = subs(STM, t, sigma);
modSTM = subs(modSTM, tau, t0);
M = simplify(int(transpose(modSTM) * transpose(C) * C * modSTM, sigma, [t0 tf]))

M = [ (77*tf)/2 - (77*t0)/2 - 12*t0^3*w^2 + 12*tf^3*w^2 - t0*exp(w*(t0*1i - tf*1i))*(36 + 18i) - t0*exp(-w*(t0*1i - tf*1i))*(36 - 18i) + tf*exp(w*(t0*1i - tf*1i))*(36 + 18i) + tf*exp(-w*(t0*1i - tf*1i))*(36 - 18i) + (exp(w*(t0*1i - tf*1i))*(- 6 - 48i))/w + (exp(-w*(t0*1i - tf*1i))*(- 6 + 48i))/w + (exp(-2*w*(t0*1i - tf*1i))*(9/2 + 27i/8))/w + (exp(2*w*(t0*1i - tf*1i))*(9/2 - 27i/8))/w - 24*t0^2*w - 24*tf^2*w + 3/w - 36*t0*tf^2*w^2 + 36*t0^2*tf*w^2 + 48*t0*tf*w, (6*sin(2*w*(t0 - tf)) - 16*sin(w*(t0 - tf)) + 12*t0^2*w^2 + 12*tf^2*w^2 + 4*t0*w - 4*tf*w + 9*sin(w*(t0 - tf))^2 + 16*sin((w*(t0 - tf))/2)^2 - 24*t0*tf*w^2 - 24*t0*w*sin(w*(t0 - tf)) + 24*tf*w*sin(w*(t0 - tf)) + 24*t0*w*sin((w*(t0 - tf))/2)^2 - 24*tf*w*sin((w*(t0 - tf))/2)^2)/(2*w^2),      -(6*cos(w*(t0 - tf)) - 3*sin(w*(t0 - tf)) + 3*t0^2*w^2 + 3*tf^2*w^2 + 4*t0*w - 4*tf*w - 6*t0*tf*w^2 - 6)/w, (15*cos(atan(3/4) - 2*t0*w + 2*tf*w) - 14*cos(w*(t0 - tf)) + 112*sin(w*(t0 - tf)) - 24*t0^2*w^2 - 12*t0^3*w^3 - 24*tf^2*w^2 + 12*tf^3*w^3 - 46*t0*w + 46*tf*w + 48*t0*tf*w^2 - 84*t0*w*cos(w*(t0 - tf)) + 84*tf*w*cos(w*(t0 - tf)) + 42*t0*w*sin(w*(t0 - tf)) - 42*tf*w*sin(w*(t0 - tf)) - 36*t0*tf^2*w^3 + 36*t0^2*tf*w^3 + 2)/(2*w^2); ...
	                                                                                                                                                                               (6*sin(2*w*(t0 - tf)) - 16*sin(w*(t0 - tf)) + 12*t0^2*w^2 + 12*tf^2*w^2 + 4*t0*w - 4*tf*w + 9*sin(w*(t0 - tf))^2 + 16*sin((w*(t0 - tf))/2)^2 - 24*t0*tf*w^2 - 24*t0*w*sin(w*(t0 - tf)) + 24*tf*w*sin(w*(t0 - tf)) + 24*t0*w*sin((w*(t0 - tf))/2)^2 - 24*tf*w*sin((w*(t0 - tf))/2)^2)/(2*w^2),                                                                                                                                                                                        -(3*sin(2*w*(t0 - tf)) - 32*sin(w*(t0 - tf)) + 26*t0*w - 26*tf*w + 32*sin((w*(t0 - tf))/2)^4)/(4*w^3),                                       (2*sin((w*(t0 - tf))/2)^2)/w^2 - (2*tf - 2*t0 + (2*sin(w*(t0 - tf)))/w)/w,                                                                                        (2*sin(2*w*(t0 - tf)) - 5*sin(w*(t0 - tf)) + 3*t0^2*w^2 + 3*tf^2*w^2 + t0*w - tf*w + 3*sin(w*(t0 - tf))^2 - 6*t0*tf*w^2 - 6*t0*w*sin(w*(t0 - tf)) + 6*tf*w*sin(w*(t0 - tf)) + 6*t0*w*sin((w*(t0 - tf))/2)^2 - 6*tf*w*sin((w*(t0 - tf))/2)^2)/w^3; ...
	                                                                                                                                                                                                                                                                                                                                                                 -(6*cos(w*(t0 - tf)) - 3*sin(w*(t0 - tf)) + 3*t0^2*w^2 + 3*tf^2*w^2 + 4*t0*w - 4*tf*w - 6*t0*tf*w^2 - 6)/w,                                                                                                                                                                                                                    (2*sin((w*(t0 - tf))/2)^2)/w^2 - (2*tf - 2*t0 + (2*sin(w*(t0 - tf)))/w)/w,                                                                                                         tf - t0,                                                                                                                                                                                                                         -(3*t0^2*w^2 + 3*tf^2*w^2 + 4*t0*w - 4*tf*w + 4*5^(1/2)*cos(atan(1/2) + t0*w - tf*w) - 6*t0*tf*w^2 - 8)/(2*w^2); ...
	                                                                                                                                    (15*cos(atan(3/4) - 2*t0*w + 2*tf*w) - 14*cos(w*(t0 - tf)) + 112*sin(w*(t0 - tf)) - 24*t0^2*w^2 - 12*t0^3*w^3 - 24*tf^2*w^2 + 12*tf^3*w^3 - 46*t0*w + 46*tf*w + 48*t0*tf*w^2 - 84*t0*w*cos(w*(t0 - tf)) + 84*tf*w*cos(w*(t0 - tf)) + 42*t0*w*sin(w*(t0 - tf)) - 42*tf*w*sin(w*(t0 - tf)) - 36*t0*tf^2*w^3 + 36*t0^2*tf*w^3 + 2)/(2*w^2),                                             (2*sin(2*w*(t0 - tf)) - 5*sin(w*(t0 - tf)) + 3*t0^2*w^2 + 3*tf^2*w^2 + t0*w - tf*w + 3*sin(w*(t0 - tf))^2 - 6*t0*tf*w^2 - 6*t0*w*sin(w*(t0 - tf)) + 6*tf*w*sin(w*(t0 - tf)) + 6*t0*w*sin((w*(t0 - tf))/2)^2 - 6*tf*w*sin((w*(t0 - tf))/2)^2)/w^3, -(3*t0^2*w^2 + 3*tf^2*w^2 + 4*t0*w - 4*tf*w + 4*5^(1/2)*cos(atan(1/2) + t0*w - tf*w) - 6*t0*tf*w^2 - 8)/(2*w^2),                  (5*cos(atan(3/4) - 2*t0*w + 2*tf*w) - 4*cos(w*(t0 - tf)) + 32*sin(w*(t0 - tf)) - 6*t0^2*w^2 - 3*t0^3*w^3 - 6*tf^2*w^2 + 3*tf^3*w^3 - 14*t0*w + 14*tf*w + 12*t0*tf*w^2 - 24*t0*w*cos(w*(t0 - tf)) + 24*tf*w*cos(w*(t0 - tf)) + 12*t0*w*sin(w*(t0 - tf)) - 12*tf*w*sin(w*(t0 - tf)) - 9*t0*tf^2*w^3 + 9*t0^2*tf*w^3)/w^3]

% deterM = simplify(det(M));
% deterM = -(exp(-w*(t0*1i - tf*1i))*(138240 - 1105920i) - exp(2*w*(t0*1i - tf*1i))*(1240320 + 528960i) + exp(4*w*(t0*1i - tf*1i))*(19440 + 61920i) + 667200*cos(w*(t0 - tf)) + 2423040*cos(2*w*(t0 - tf)) - 1081920*cos(3*w*(t0 - tf)) - 38880*cos(4*w*(t0 - tf)) + 1804800*sin(w*(t0 - tf)) - 1057920*sin(2*w*(t0 - tf)) - 61440*sin(3*w*(t0 - tf)) + 123840*sin(4*w*(t0 - tf)) + 9900*t0^4*w^4 - 600*t0^6*w^6 + 9900*tf^4*w^4 - 600*tf^6*w^6 + exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(138240 + 103680i) + exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(46080 - 368640i) + exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(195840 + 146880i) + exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(130560 - 1044480i) - 1832736*t0*w*cos(w*(t0 - tf)) + 2653824*t0*w*cos(2*w*(t0 - tf)) - 841440*t0*w*cos(3*w*(t0 - tf)) - 62928*t0*w*cos(4*w*(t0 - tf)) + 1832736*tf*w*cos(w*(t0 - tf)) - 2653824*tf*w*cos(2*w*(t0 - tf)) + 841440*tf*w*cos(3*w*(t0 - tf)) + 62928*tf*w*cos(4*w*(t0 - tf)) + 3741888*t0*w*sin(w*(t0 - tf)) + 151968*t0*w*sin(2*w*(t0 - tf)) - 1318080*t0*w*sin(3*w*(t0 - tf)) - 22896*t0*w*sin(4*w*(t0 - tf)) - 3741888*tf*w*sin(w*(t0 - tf)) - 151968*tf*w*sin(2*w*(t0 - tf)) + 1318080*tf*w*sin(3*w*(t0 - tf)) + 22896*tf*w*sin(4*w*(t0 - tf)) + t0^2*w^2*exp(-w*(t0*1i - tf*1i))*(1171584 - 352512i) - t0^2*w^2*exp(2*w*(t0*1i - tf*1i))*(469728 - 6696i) - t0^3*w^3*exp(-w*(t0*1i - tf*1i))*(220800 - 366720i) - t0^2*w^2*exp(4*w*(t0*1i - tf*1i))*(3348 - 1836i) + t0^3*w^3*exp(2*w*(t0*1i - tf*1i))*(131616 - 41112i) - t0^4*w^4*exp(-w*(t0*1i - tf*1i))*(204480 - 97920i) + t0^3*w^3*exp(4*w*(t0*1i - tf*1i))*(2592 + 756i) - t0^4*w^4*exp(2*w*(t0*1i - tf*1i))*(38448 + 79164i) + t0^5*w^5*exp(-w*(t0*1i - tf*1i))*(2016 + 9792i) + t0^4*w^4*exp(4*w*(t0*1i - tf*1i))*(189/2 - 324i) + t0^5*w^5*exp(2*w*(t0*1i - tf*1i))*(1080 - 810i) - t0^6*w^6*exp(-w*(t0*1i - tf*1i))*(8640 - 4320i) + tf^2*w^2*exp(-w*(t0*1i - tf*1i))*(1171584 - 352512i) - tf^2*w^2*exp(2*w*(t0*1i - tf*1i))*(469728 - 6696i) + tf^3*w^3*exp(-w*(t0*1i - tf*1i))*(220800 - 366720i) - tf^2*w^2*exp(4*w*(t0*1i - tf*1i))*(3348 - 1836i) - tf^3*w^3*exp(2*w*(t0*1i - tf*1i))*(131616 - 41112i) - tf^4*w^4*exp(-w*(t0*1i - tf*1i))*(204480 - 97920i) - tf^3*w^3*exp(4*w*(t0*1i - tf*1i))*(2592 + 756i) - tf^4*w^4*exp(2*w*(t0*1i - tf*1i))*(38448 + 79164i) - tf^5*w^5*exp(-w*(t0*1i - tf*1i))*(2016 + 9792i) + tf^4*w^4*exp(4*w*(t0*1i - tf*1i))*(189/2 - 324i) - tf^5*w^5*exp(2*w*(t0*1i - tf*1i))*(1080 - 810i) - tf^6*w^6*exp(-w*(t0*1i - tf*1i))*(8640 - 4320i) - 39600*t0*tf^3*w^4 - 39600*t0^3*tf*w^4 + 3600*t0*tf^5*w^6 + 3600*t0^5*tf*w^6 + t0*w*exp(-w*(t0*1i - tf*1i))*(1029888 - 2018304i) - t0*w*exp(2*w*(t0*1i - tf*1i))*(1326912 - 111984i) + t0*w*exp(4*w*(t0*1i - tf*1i))*(31464 - 11448i) - tf*w*exp(-w*(t0*1i - tf*1i))*(1029888 - 2018304i) + tf*w*exp(2*w*(t0*1i - tf*1i))*(1326912 - 111984i) - tf*w*exp(4*w*(t0*1i - tf*1i))*(31464 - 11448i) + 59400*t0^2*tf^2*w^4 - 9000*t0^2*tf^4*w^6 + 12000*t0^3*tf^3*w^6 - 9000*t0^4*tf^2*w^6 - 1906128*t0^2*w^2*cos(w*(t0 - tf)) + 968256*t0^2*w^2*cos(2*w*(t0 - tf)) + 423600*t0^3*w^3*cos(w*(t0 - tf)) + 372816*t0^2*w^2*cos(3*w*(t0 - tf)) + 6696*t0^2*w^2*cos(4*w*(t0 - tf)) - 263232*t0^3*w^3*cos(2*w*(t0 - tf)) + 445440*t0^4*w^4*cos(w*(t0 - tf)) - 102960*t0^3*w^3*cos(3*w*(t0 - tf)) - 5184*t0^3*w^3*cos(4*w*(t0 - tf)) + 76596*t0^4*w^4*cos(2*w*(t0 - tf)) - 1872*t0^5*w^5*cos(w*(t0 - tf)) + 10944*t0^4*w^4*cos(3*w*(t0 - tf)) - 189*t0^4*w^4*cos(4*w*(t0 - tf)) - 2160*t0^5*w^5*cos(2*w*(t0 - tf)) + 17280*t0^6*w^6*cos(w*(t0 - tf)) + 4752*t0^5*w^5*cos(3*w*(t0 - tf)) - 1906128*tf^2*w^2*cos(w*(t0 - tf)) + 968256*tf^2*w^2*cos(2*w*(t0 - tf)) - 423600*tf^3*w^3*cos(w*(t0 - tf)) + 372816*tf^2*w^2*cos(3*w*(t0 - tf)) + 6696*tf^2*w^2*cos(4*w*(t0 - tf)) + 263232*tf^3*w^3*cos(2*w*(t0 - tf)) + 445440*tf^4*w^4*cos(w*(t0 - tf)) + 102960*tf^3*w^3*cos(3*w*(t0 - tf)) + 5184*tf^3*w^3*cos(4*w*(t0 - tf)) + 76596*tf^4*w^4*cos(2*w*(t0 - tf)) + 1872*tf^5*w^5*cos(w*(t0 - tf)) + 10944*tf^4*w^4*cos(3*w*(t0 - tf)) - 189*tf^4*w^4*cos(4*w*(t0 - tf)) + 2160*tf^5*w^5*cos(2*w*(t0 - tf)) + 17280*tf^6*w^6*cos(w*(t0 - tf)) - 4752*tf^5*w^5*cos(3*w*(t0 - tf)) + 743904*t0^2*w^2*sin(w*(t0 - tf)) + 13392*t0^2*w^2*sin(2*w*(t0 - tf)) - 775440*t0^3*w^3*sin(w*(t0 - tf)) - 259488*t0^2*w^2*sin(3*w*(t0 - tf)) + 3672*t0^2*w^2*sin(4*w*(t0 - tf)) - 77424*t0^3*w^3*sin(2*w*(t0 - tf)) - 208080*t0^4*w^4*sin(w*(t0 - tf)) - 720*t0^3*w^3*sin(3*w*(t0 - tf)) + 1512*t0^3*w^3*sin(4*w*(t0 - tf)) - 158328*t0^4*w^4*sin(2*w*(t0 - tf)) - 15264*t0^5*w^5*sin(w*(t0 - tf)) - 42192*t0^4*w^4*sin(3*w*(t0 - tf)) - 648*t0^4*w^4*sin(4*w*(t0 - tf)) - 1620*t0^5*w^5*sin(2*w*(t0 - tf)) - 8640*t0^6*w^6*sin(w*(t0 - tf)) + 864*t0^5*w^5*sin(3*w*(t0 - tf)) + 743904*tf^2*w^2*sin(w*(t0 - tf)) + 13392*tf^2*w^2*sin(2*w*(t0 - tf)) + 775440*tf^3*w^3*sin(w*(t0 - tf)) - 259488*tf^2*w^2*sin(3*w*(t0 - tf)) + 3672*tf^2*w^2*sin(4*w*(t0 - tf)) + 77424*tf^3*w^3*sin(2*w*(t0 - tf)) - 208080*tf^4*w^4*sin(w*(t0 - tf)) + 720*tf^3*w^3*sin(3*w*(t0 - tf)) - 1512*tf^3*w^3*sin(4*w*(t0 - tf)) - 158328*tf^4*w^4*sin(2*w*(t0 - tf)) + 15264*tf^5*w^5*sin(w*(t0 - tf)) - 42192*tf^4*w^4*sin(3*w*(t0 - tf)) - 648*tf^4*w^4*sin(4*w*(t0 - tf)) + 1620*tf^5*w^5*sin(2*w*(t0 - tf)) - 8640*tf^6*w^6*sin(w*(t0 - tf)) - 864*tf^5*w^5*sin(3*w*(t0 - tf)) - 1487808*t0*tf*w^2*sin(w*(t0 - tf)) - 26784*t0*tf*w^2*sin(2*w*(t0 - tf)) + 518976*t0*tf*w^2*sin(3*w*(t0 - tf)) - 7344*t0*tf*w^2*sin(4*w*(t0 - tf)) - t0^2*tf^2*w^4*exp(-w*(t0*1i - tf*1i))*(1226880 - 587520i) - t0^2*tf^2*w^4*exp(2*w*(t0*1i - tf*1i))*(230688 + 474984i) + t0^3*tf^2*w^5*exp(w*(t0*1i - tf*1i))*(20160 - 97920i) + t0^3*tf^2*w^5*exp(-w*(t0*1i - tf*1i))*(20160 + 97920i) + t0^2*tf^2*w^4*exp(4*w*(t0*1i - tf*1i))*(567 - 1944i) - t0^2*tf^3*w^5*exp(2*w*(t0*1i - tf*1i))*(10800 - 8100i) + t0^3*tf^2*w^5*exp(-2*w*(t0*1i - tf*1i))*(10800 + 8100i) + t0^3*tf^3*w^6*exp(w*(t0*1i - tf*1i))*(172800 + 86400i) - t0^2*tf^4*w^6*exp(-w*(t0*1i - tf*1i))*(129600 - 64800i) - t0^4*tf^2*w^6*exp(-w*(t0*1i - tf*1i))*(129600 - 64800i) - t0^2*w^2*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(17280 + 12960i) - t0^2*w^2*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(402048 - 140544i) + t0^3*w^3*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(15552 + 11664i) + t0^3*w^3*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(44928 + 3456i) - t0^4*w^4*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(21312 - 14976i) - t0^5*w^5*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(3456 - 1728i) - tf^2*w^2*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(17280 + 12960i) - tf^2*w^2*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(402048 - 140544i) - tf^3*w^3*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(15552 + 11664i) - tf^3*w^3*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(44928 + 3456i) - tf^4*w^4*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(21312 - 14976i) + tf^5*w^5*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(3456 - 1728i) + t0^2*w^2*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(8640 + 6480i) + t0^2*w^2*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(123264 - 52992i) - t0^3*w^3*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(12096 + 9072i) - t0^3*w^3*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2304 + 33408i) + t0^4*w^4*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(27216 - 10368i) - t0^5*w^5*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2592 - 1296i) + tf^2*w^2*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(8640 + 6480i) + tf^2*w^2*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(123264 - 52992i) + tf^3*w^3*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(12096 + 9072i) + tf^3*w^3*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2304 + 33408i) + tf^4*w^4*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(27216 - 10368i) + tf^5*w^5*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2592 - 1296i) + 1270800*t0*tf^2*w^3*cos(w*(t0 - tf)) - 1270800*t0^2*tf*w^3*cos(w*(t0 - tf)) - 789696*t0*tf^2*w^3*cos(2*w*(t0 - tf)) - 1781760*t0*tf^3*w^4*cos(w*(t0 - tf)) + 789696*t0^2*tf*w^3*cos(2*w*(t0 - tf)) - 1781760*t0^3*tf*w^4*cos(w*(t0 - tf)) - 308880*t0*tf^2*w^3*cos(3*w*(t0 - tf)) + 308880*t0^2*tf*w^3*cos(3*w*(t0 - tf)) - 15552*t0*tf^2*w^3*cos(4*w*(t0 - tf)) - 306384*t0*tf^3*w^4*cos(2*w*(t0 - tf)) - 9360*t0*tf^4*w^5*cos(w*(t0 - tf)) + 15552*t0^2*tf*w^3*cos(4*w*(t0 - tf)) - 306384*t0^3*tf*w^4*cos(2*w*(t0 - tf)) + 9360*t0^4*tf*w^5*cos(w*(t0 - tf)) - 43776*t0*tf^3*w^4*cos(3*w*(t0 - tf)) - 43776*t0^3*tf*w^4*cos(3*w*(t0 - tf)) + 756*t0*tf^3*w^4*cos(4*w*(t0 - tf)) - 10800*t0*tf^4*w^5*cos(2*w*(t0 - tf)) - 103680*t0*tf^5*w^6*cos(w*(t0 - tf)) + 756*t0^3*tf*w^4*cos(4*w*(t0 - tf)) + 10800*t0^4*tf*w^5*cos(2*w*(t0 - tf)) - 103680*t0^5*tf*w^6*cos(w*(t0 - tf)) + 23760*t0*tf^4*w^5*cos(3*w*(t0 - tf)) - 23760*t0^4*tf*w^5*cos(3*w*(t0 - tf)) - t0*tf*w^2*exp(-w*(t0*1i - tf*1i))*(2343168 - 705024i) + t0*tf*w^2*exp(2*w*(t0*1i - tf*1i))*(939456 - 13392i) + t0*tf*w^2*exp(4*w*(t0*1i - tf*1i))*(6696 - 3672i) + t0*w*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(99072 + 74304i) + t0*w*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(208128 + 408576i) - tf*w*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(99072 + 74304i) - tf*w*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(208128 + 408576i) - 2326320*t0*tf^2*w^3*sin(w*(t0 - tf)) + 2326320*t0^2*tf*w^3*sin(w*(t0 - tf)) - 232272*t0*tf^2*w^3*sin(2*w*(t0 - tf)) + 832320*t0*tf^3*w^4*sin(w*(t0 - tf)) + 232272*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 832320*t0^3*tf*w^4*sin(w*(t0 - tf)) - 2160*t0*tf^2*w^3*sin(3*w*(t0 - tf)) + 2160*t0^2*tf*w^3*sin(3*w*(t0 - tf)) + 4536*t0*tf^2*w^3*sin(4*w*(t0 - tf)) + 633312*t0*tf^3*w^4*sin(2*w*(t0 - tf)) - 76320*t0*tf^4*w^5*sin(w*(t0 - tf)) - 4536*t0^2*tf*w^3*sin(4*w*(t0 - tf)) + 633312*t0^3*tf*w^4*sin(2*w*(t0 - tf)) + 76320*t0^4*tf*w^5*sin(w*(t0 - tf)) + 168768*t0*tf^3*w^4*sin(3*w*(t0 - tf)) + 168768*t0^3*tf*w^4*sin(3*w*(t0 - tf)) + 2592*t0*tf^3*w^4*sin(4*w*(t0 - tf)) - 8100*t0*tf^4*w^5*sin(2*w*(t0 - tf)) + 51840*t0*tf^5*w^6*sin(w*(t0 - tf)) + 2592*t0^3*tf*w^4*sin(4*w*(t0 - tf)) + 8100*t0^4*tf*w^5*sin(2*w*(t0 - tf)) + 51840*t0^5*tf*w^6*sin(w*(t0 - tf)) + 4320*t0*tf^4*w^5*sin(3*w*(t0 - tf)) - 4320*t0^4*tf*w^5*sin(3*w*(t0 - tf)) + t0*w*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(31104 + 23328i) + t0*w*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(804096 - 557568i) - tf*w*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(31104 + 23328i) - tf*w*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(804096 - 557568i) + 2672640*t0^2*tf^2*w^4*cos(w*(t0 - tf)) + 459576*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 18720*t0^2*tf^3*w^5*cos(w*(t0 - tf)) - 18720*t0^3*tf^2*w^5*cos(w*(t0 - tf)) + 65664*t0^2*tf^2*w^4*cos(3*w*(t0 - tf)) - 1134*t0^2*tf^2*w^4*cos(4*w*(t0 - tf)) + 21600*t0^2*tf^3*w^5*cos(2*w*(t0 - tf)) + 259200*t0^2*tf^4*w^6*cos(w*(t0 - tf)) - 21600*t0^3*tf^2*w^5*cos(2*w*(t0 - tf)) - 345600*t0^3*tf^3*w^6*cos(w*(t0 - tf)) + 259200*t0^4*tf^2*w^6*cos(w*(t0 - tf)) - 47520*t0^2*tf^3*w^5*cos(3*w*(t0 - tf)) + 47520*t0^3*tf^2*w^5*cos(3*w*(t0 - tf)) + t0^2*tf*w^3*exp(w*(t0*1i - tf*1i))*(662400 + 1100160i) + t0^2*tf*w^3*exp(-w*(t0*1i - tf*1i))*(662400 - 1100160i) + t0*tf^2*w^3*exp(2*w*(t0*1i - tf*1i))*(394848 - 123336i) - t0^2*tf*w^3*exp(-2*w*(t0*1i - tf*1i))*(394848 + 123336i) + t0^3*tf*w^4*exp(w*(t0*1i - tf*1i))*(817920 + 391680i) + t0^3*tf*w^4*exp(-w*(t0*1i - tf*1i))*(817920 - 391680i) + t0*tf^2*w^3*exp(4*w*(t0*1i - tf*1i))*(7776 + 2268i) + t0*tf^3*w^4*exp(2*w*(t0*1i - tf*1i))*(153792 + 316656i) - t0^2*tf*w^3*exp(-4*w*(t0*1i - tf*1i))*(7776 - 2268i) + t0^3*tf*w^4*exp(-2*w*(t0*1i - tf*1i))*(153792 - 316656i) - t0^4*tf*w^5*exp(w*(t0*1i - tf*1i))*(10080 - 48960i) - t0^4*tf*w^5*exp(-w*(t0*1i - tf*1i))*(10080 + 48960i) - t0*tf^3*w^4*exp(4*w*(t0*1i - tf*1i))*(378 - 1296i) + t0*tf^4*w^5*exp(2*w*(t0*1i - tf*1i))*(5400 - 4050i) - t0^3*tf*w^4*exp(-4*w*(t0*1i - tf*1i))*(378 + 1296i) - t0^4*tf*w^5*exp(-2*w*(t0*1i - tf*1i))*(5400 + 4050i) + t0^5*tf*w^6*exp(w*(t0*1i - tf*1i))*(51840 + 25920i) + t0^5*tf*w^6*exp(-w*(t0*1i - tf*1i))*(51840 - 25920i) - 1248480*t0^2*tf^2*w^4*sin(w*(t0 - tf)) - 949968*t0^2*tf^2*w^4*sin(2*w*(t0 - tf)) + 152640*t0^2*tf^3*w^5*sin(w*(t0 - tf)) - 152640*t0^3*tf^2*w^5*sin(w*(t0 - tf)) - 253152*t0^2*tf^2*w^4*sin(3*w*(t0 - tf)) - 3888*t0^2*tf^2*w^4*sin(4*w*(t0 - tf)) + 16200*t0^2*tf^3*w^5*sin(2*w*(t0 - tf)) - 129600*t0^2*tf^4*w^6*sin(w*(t0 - tf)) - 16200*t0^3*tf^2*w^5*sin(2*w*(t0 - tf)) + 172800*t0^3*tf^3*w^6*sin(w*(t0 - tf)) - 129600*t0^4*tf^2*w^6*sin(w*(t0 - tf)) - 8640*t0^2*tf^3*w^5*sin(3*w*(t0 - tf)) + 8640*t0^3*tf^2*w^5*sin(3*w*(t0 - tf)) + 3812256*t0*tf*w^2*cos(w*(t0 - tf)) - 1936512*t0*tf*w^2*cos(2*w*(t0 - tf)) - 745632*t0*tf*w^2*cos(3*w*(t0 - tf)) - 13392*t0*tf*w^2*cos(4*w*(t0 - tf)) - t0^2*tf^2*w^4*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(127872 - 89856i) - t0^3*tf^2*w^5*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(34560 + 17280i) - t0^3*tf^2*w^5*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(34560 - 17280i) + t0^2*tf^2*w^4*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(163296 - 62208i) - t0^3*tf^2*w^5*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(25920 + 12960i) - t0^3*tf^2*w^5*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(25920 - 12960i) + t0*tf*w^2*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(34560 + 25920i) + t0*tf*w^2*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(804096 - 281088i) - t0*tf*w^2*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(17280 + 12960i) - t0*tf*w^2*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(246528 - 105984i) + t0*tf^2*w^3*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(46656 + 34992i) - t0^2*tf*w^3*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(134784 - 10368i) - t0^2*tf*w^3*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(46656 - 34992i) - t0^2*tf*w^3*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(134784 + 10368i) + t0^3*tf*w^4*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(85248 + 59904i) + t0^3*tf*w^4*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(85248 - 59904i) + t0^4*tf*w^5*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(17280 + 8640i) + t0^4*tf*w^5*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(17280 - 8640i) - t0*tf^2*w^3*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(36288 + 27216i) + t0^2*tf*w^3*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(6912 - 100224i) + t0^2*tf*w^3*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(36288 - 27216i) + t0^2*tf*w^3*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(6912 + 100224i) - t0^3*tf*w^4*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(108864 + 41472i) - t0^3*tf*w^4*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(108864 - 41472i) + t0^4*tf*w^5*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(12960 + 6480i) + t0^4*tf*w^5*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(12960 - 6480i) - 172800 - exp(-2*w*(t0*1i - tf*1i))*(1240320 - 528960i) + exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(46080 + 368640i) + exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(130560 + 1044480i) + t0^2*w^2*exp(w*(t0*1i - tf*1i))*(1171584 + 352512i) - t0^3*w^3*exp(w*(t0*1i - tf*1i))*(220800 + 366720i) + t0^3*w^3*exp(-2*w*(t0*1i - tf*1i))*(131616 + 41112i) + t0^3*w^3*exp(-4*w*(t0*1i - tf*1i))*(2592 - 756i) + t0^5*w^5*exp(w*(t0*1i - tf*1i))*(2016 - 9792i) + t0^5*w^5*exp(-2*w*(t0*1i - tf*1i))*(1080 + 810i) + tf^2*w^2*exp(w*(t0*1i - tf*1i))*(1171584 + 352512i) + tf^3*w^3*exp(w*(t0*1i - tf*1i))*(220800 + 366720i) - tf^3*w^3*exp(-2*w*(t0*1i - tf*1i))*(131616 + 41112i) - tf^3*w^3*exp(-4*w*(t0*1i - tf*1i))*(2592 - 756i) - tf^5*w^5*exp(w*(t0*1i - tf*1i))*(2016 - 9792i) - tf^5*w^5*exp(-2*w*(t0*1i - tf*1i))*(1080 + 810i) + t0*w*exp(w*(t0*1i - tf*1i))*(1029888 + 2018304i) + t0*w*exp(-4*w*(t0*1i - tf*1i))*(31464 + 11448i) + tf*w*exp(-2*w*(t0*1i - tf*1i))*(1326912 + 111984i) - t0^2*tf^2*w^4*exp(w*(t0*1i - tf*1i))*(1226880 + 587520i) - t0^2*tf^3*w^5*exp(w*(t0*1i - tf*1i))*(20160 - 97920i) + t0^2*tf^2*w^4*exp(-4*w*(t0*1i - tf*1i))*(567 + 1944i) - t0^2*tf^4*w^6*exp(w*(t0*1i - tf*1i))*(129600 + 64800i) - t0^4*tf^2*w^6*exp(w*(t0*1i - tf*1i))*(129600 + 64800i) - t0^2*w^2*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(402048 + 140544i) + t0^3*w^3*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(44928 - 3456i) - t0^4*w^4*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(21312 + 14976i) - tf^2*w^2*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(402048 + 140544i) - tf^3*w^3*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(44928 - 3456i) - tf^4*w^4*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(21312 + 14976i) + t0^2*w^2*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(123264 + 52992i) - t0^3*w^3*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2304 - 33408i) + t0^4*w^4*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(27216 + 10368i) + tf^2*w^2*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(123264 + 52992i) + tf^3*w^3*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2304 - 33408i) + tf^4*w^4*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(27216 + 10368i) - t0*tf*w^2*exp(w*(t0*1i - tf*1i))*(2343168 + 705024i) + t0*tf*w^2*exp(-4*w*(t0*1i - tf*1i))*(6696 + 3672i) + t0*w*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(99072 - 74304i) - tf*w*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(99072 - 74304i) + t0*w*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(31104 - 23328i) - tf*w*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(31104 - 23328i) - t0*tf^2*w^3*exp(-w*(t0*1i - tf*1i))*(662400 - 1100160i) + t0*tf^3*w^4*exp(w*(t0*1i - tf*1i))*(817920 + 391680i) + t0*tf^3*w^4*exp(-w*(t0*1i - tf*1i))*(817920 - 391680i) + t0*tf^3*w^4*exp(-2*w*(t0*1i - tf*1i))*(153792 - 316656i) - t0^2*tf*w^3*exp(4*w*(t0*1i - tf*1i))*(7776 + 2268i) + t0*tf^4*w^5*exp(-w*(t0*1i - tf*1i))*(10080 + 48960i) + t0*tf^4*w^5*exp(-2*w*(t0*1i - tf*1i))*(5400 + 4050i) - t0^3*tf*w^4*exp(4*w*(t0*1i - tf*1i))*(378 - 1296i) + t0*tf^5*w^6*exp(-w*(t0*1i - tf*1i))*(51840 - 25920i) + t0^2*tf^3*w^5*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(34560 + 17280i) + t0^2*tf^2*w^4*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(163296 + 62208i) + t0^2*tf^3*w^5*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(25920 - 12960i) + t0*tf*w^2*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(34560 - 25920i) - t0*tf*w^2*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(17280 - 12960i) + t0*tf^2*w^3*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(46656 - 34992i) + t0*tf^2*w^3*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(134784 + 10368i) + t0*tf^3*w^4*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(85248 - 59904i) - t0*tf^4*w^5*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(17280 - 8640i) - t0*tf^2*w^3*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(36288 - 27216i) - t0*tf^2*w^3*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(6912 + 100224i) - t0*tf^3*w^4*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(108864 - 41472i) - t0*tf^4*w^5*exp(-w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(12960 - 6480i) + exp(-4*w*(t0*1i - tf*1i))*(19440 - 61920i) + exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(195840 - 146880i) - t0^2*w^2*exp(-4*w*(t0*1i - tf*1i))*(3348 + 1836i) - t0^4*w^4*exp(-2*w*(t0*1i - tf*1i))*(38448 - 79164i) - t0^6*w^6*exp(w*(t0*1i - tf*1i))*(8640 + 4320i) - tf^2*w^2*exp(-4*w*(t0*1i - tf*1i))*(3348 + 1836i) - tf^4*w^4*exp(-2*w*(t0*1i - tf*1i))*(38448 - 79164i) - tf^6*w^6*exp(w*(t0*1i - tf*1i))*(8640 + 4320i) - tf*w*exp(w*(t0*1i - tf*1i))*(1029888 + 2018304i) - t0^2*tf^2*w^4*exp(-2*w*(t0*1i - tf*1i))*(230688 - 474984i) - t0^2*tf^3*w^5*exp(-2*w*(t0*1i - tf*1i))*(10800 + 8100i) + t0^3*tf^3*w^6*exp(-w*(t0*1i - tf*1i))*(172800 - 86400i) + t0^3*w^3*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(15552 - 11664i) - tf^2*w^2*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(17280 - 12960i) + tf^5*w^5*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(3456 + 1728i) - t0^3*w^3*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(12096 - 9072i) + tf^2*w^2*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(8640 - 6480i) + tf^5*w^5*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2592 + 1296i) + t0*w*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(208128 - 408576i) + t0*w*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(804096 + 557568i) - t0*tf^2*w^3*exp(w*(t0*1i - tf*1i))*(662400 + 1100160i) - t0^2*tf*w^3*exp(2*w*(t0*1i - tf*1i))*(394848 - 123336i) + t0*tf^4*w^5*exp(w*(t0*1i - tf*1i))*(10080 - 48960i) - t0*tf^3*w^4*exp(-4*w*(t0*1i - tf*1i))*(378 + 1296i) - t0^4*tf*w^5*exp(2*w*(t0*1i - tf*1i))*(5400 - 4050i) + t0^2*tf^3*w^5*exp(-w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(34560 - 17280i) + t0*tf*w^2*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(804096 + 281088i) + t0*tf^2*w^3*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(134784 - 10368i) + t0*tf^3*w^4*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(85248 + 59904i) - t0*tf^2*w^3*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(6912 - 100224i) - t0*tf^3*w^4*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(108864 + 41472i) + exp(w*(t0*1i - tf*1i))*(138240 + 1105920i) - t0^2*w^2*exp(-2*w*(t0*1i - tf*1i))*(469728 + 6696i) + t0^4*w^4*exp(-4*w*(t0*1i - tf*1i))*(189/2 + 324i) - tf^4*w^4*exp(w*(t0*1i - tf*1i))*(204480 + 97920i) - t0*w*exp(-2*w*(t0*1i - tf*1i))*(1326912 + 111984i) - t0^2*tf^3*w^5*exp(-w*(t0*1i - tf*1i))*(20160 + 97920i) - t0^2*w^2*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(17280 - 12960i) - tf^3*w^3*exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(15552 - 11664i) - t0^5*w^5*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(2592 + 1296i) + t0*tf*w^2*exp(-2*w*(t0*1i - tf*1i))*(939456 + 13392i) - tf*w*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(804096 + 557568i) + t0*tf^2*w^3*exp(-4*w*(t0*1i - tf*1i))*(7776 - 2268i) + t0*tf^5*w^6*exp(w*(t0*1i - tf*1i))*(51840 + 25920i) + t0^2*tf^3*w^5*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(25920 + 12960i) - t0^2*tf*w^3*exp(-2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(46656 + 34992i) + t0^2*tf*w^3*exp(-2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(36288 + 27216i) + exp(2*w*(t0*1i - tf*1i))*cos(w*(t0 - tf))*(138240 - 103680i) - tf^2*w^2*exp(-2*w*(t0*1i - tf*1i))*(469728 + 6696i) - tf*w*exp(-4*w*(t0*1i - tf*1i))*(31464 + 11448i) - t0^5*w^5*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(3456 + 1728i) + tf^3*w^3*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(12096 - 9072i) + t0*tf^2*w^3*exp(-2*w*(t0*1i - tf*1i))*(394848 + 123336i) - t0^2*tf^2*w^4*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(127872 + 89856i) - t0*tf^4*w^5*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(17280 + 8640i) - t0^4*w^4*exp(w*(t0*1i - tf*1i))*(204480 + 97920i) + t0^3*tf^2*w^5*exp(2*w*(t0*1i - tf*1i))*(10800 - 8100i) - tf*w*exp(w*(t0*1i - tf*1i))*cos(2*w*(t0 - tf))*(208128 - 408576i) - t0*tf*w^2*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(246528 + 105984i) + tf^4*w^4*exp(-4*w*(t0*1i - tf*1i))*(189/2 + 324i) + t0^3*tf*w^4*exp(2*w*(t0*1i - tf*1i))*(153792 + 316656i) + t0^2*w^2*exp(2*w*(t0*1i - tf*1i))*sin(w*(t0 - tf))*(8640 - 6480i) - t0*tf^4*w^5*exp(w*(t0*1i - tf*1i))*sin(2*w*(t0 - tf))*(12960 + 6480i))/(128*w^8);
% if M is nonsingular, sys is observable
%}

% *** start part (e) ***
syms theta;
x0 = [0;0;theta;0];
xf = [0;0;(w*tf-theta);0];
% iW = simplify(inv(W))
%{
iW =  [(4*w*(735*t0^5*w^7 - 5212*t0^3*w^5 + 5212*tf^3*w^5 - 735*tf^5*w^7 + 18432*w^2*sin(w*(t0 - tf)) - 9216*w^2*sin(2*w*(t0 - tf)) - 6928*t0*w^3 + 6928*tf*w^3 - 15636*t0*tf^2*w^5 + 15636*t0^2*tf*w^5 + 3675*t0*tf^4*w^7 - 3675*t0^4*tf*w^7 - 5888*t0*w^3*cos(w*(t0 - tf)) + 12816*t0*w^3*cos(2*w*(t0 - tf)) + 5888*tf*w^3*cos(w*(t0 - tf)) - 12816*tf*w^3*cos(2*w*(t0 - tf)) - 7350*t0^2*tf^3*w^7 + 7350*t0^3*tf^2*w^7 + 2016*t0^3*w^5*cos(w*(t0 - tf)) - 756*t0^3*w^5*cos(2*w*(t0 - tf)) - 2016*tf^3*w^5*cos(w*(t0 - tf)) + 756*tf^3*w^5*cos(2*w*(t0 - tf)) + 7488*t0^2*w^4*sin(w*(t0 - tf)) + 4968*t0^2*w^4*sin(2*w*(t0 - tf)) + 720*t0^4*w^6*sin(w*(t0 - tf)) - (81*t0^4*w^6*sin(2*w*(t0 - tf)))/2 + 7488*tf^2*w^4*sin(w*(t0 - tf)) + 4968*tf^2*w^4*sin(2*w*(t0 - tf)) + 720*tf^4*w^6*sin(w*(t0 - tf)) - (81*tf^4*w^6*sin(2*w*(t0 - tf)))/2 - 14976*t0*tf*w^4*sin(w*(t0 - tf)) - 9936*t0*tf*w^4*sin(2*w*(t0 - tf)) + 6048*t0*tf^2*w^5*cos(w*(t0 - tf)) - 6048*t0^2*tf*w^5*cos(w*(t0 - tf)) - 2268*t0*tf^2*w^5*cos(2*w*(t0 - tf)) + 2268*t0^2*tf*w^5*cos(2*w*(t0 - tf)) - 2880*t0*tf^3*w^6*sin(w*(t0 - tf)) - 2880*t0^3*tf*w^6*sin(w*(t0 - tf)) + 162*t0*tf^3*w^6*sin(2*w*(t0 - tf)) + 162*t0^3*tf*w^6*sin(2*w*(t0 - tf)) + 4320*t0^2*tf^2*w^6*sin(w*(t0 - tf)) - 243*t0^2*tf^2*w^6*sin(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152), -(16*((1107*t0^4*w^6)/8 - (1385*t0^2*w^4)/2 - (1385*tf^2*w^4)/2 + (1107*tf^4*w^6)/8 + 512*w^2*cos(w*(t0 - tf)) - 128*w^2*cos(2*w*(t0 - tf)) - 384*w^2 + 1385*t0*tf*w^4 - (1107*t0*tf^3*w^6)/2 - (1107*t0^3*tf*w^6)/2 + 1104*t0*w^3*sin(w*(t0 - tf)) - 552*t0*w^3*sin(2*w*(t0 - tf)) - 1104*tf*w^3*sin(w*(t0 - tf)) + 552*tf*w^3*sin(2*w*(t0 - tf)) + (3321*t0^2*tf^2*w^6)/4 + 400*t0^2*w^4*cos(w*(t0 - tf)) + (585*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 30*t0^4*w^6*cos(w*(t0 - tf)) - (27*t0^4*w^6*cos(2*w*(t0 - tf)))/8 + 400*tf^2*w^4*cos(w*(t0 - tf)) + (585*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + 30*tf^4*w^6*cos(w*(t0 - tf)) - (27*tf^4*w^6*cos(2*w*(t0 - tf)))/8 + 24*t0^3*w^5*sin(w*(t0 - tf)) + 54*t0^3*w^5*sin(2*w*(t0 - tf)) - 24*tf^3*w^5*sin(w*(t0 - tf)) - 54*tf^3*w^5*sin(2*w*(t0 - tf)) - 120*t0*tf^3*w^6*cos(w*(t0 - tf)) - 120*t0^3*tf*w^6*cos(w*(t0 - tf)) + (27*t0*tf^3*w^6*cos(2*w*(t0 - tf)))/2 + (27*t0^3*tf*w^6*cos(2*w*(t0 - tf)))/2 + 72*t0*tf^2*w^5*sin(w*(t0 - tf)) - 72*t0^2*tf*w^5*sin(w*(t0 - tf)) + 162*t0*tf^2*w^5*sin(2*w*(t0 - tf)) - 162*t0^2*tf*w^5*sin(2*w*(t0 - tf)) + 180*t0^2*tf^2*w^6*cos(w*(t0 - tf)) - (81*t0^2*tf^2*w^6*cos(2*w*(t0 - tf)))/4 - 800*t0*tf*w^4*cos(w*(t0 - tf)) - 585*t0*tf*w^4*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152), (8*w*(75*t0^4*w^6 - (933*t0^2*w^4)/2 - (933*tf^2*w^4)/2 + 75*tf^4*w^6 - 1536*w^2*cos(w*(t0 - tf)) + 384*w^2*cos(2*w*(t0 - tf)) + 1152*w^2 + 933*t0*tf*w^4 - 300*t0*tf^3*w^6 - 300*t0^3*tf*w^6 - 288*t0*w^3*sin(w*(t0 - tf)) + 144*t0*w^3*sin(2*w*(t0 - tf)) + 288*tf*w^3*sin(w*(t0 - tf)) - 144*tf*w^3*sin(2*w*(t0 - tf)) + 450*t0^2*tf^2*w^6 + 480*t0^2*w^4*cos(w*(t0 - tf)) - (27*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 480*tf^2*w^4*cos(w*(t0 - tf)) - (27*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + 90*t0^3*w^5*sin(w*(t0 - tf)) - 90*tf^3*w^5*sin(w*(t0 - tf)) + 270*t0*tf^2*w^5*sin(w*(t0 - tf)) - 270*t0^2*tf*w^5*sin(w*(t0 - tf)) - 960*t0*tf*w^4*cos(w*(t0 - tf)) + 27*t0*tf*w^4*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),              (8*(195*t0^5*w^7 - 1453*t0^3*w^5 + 1453*tf^3*w^5 - 195*tf^5*w^7 + 5632*w^2*sin(w*(t0 - tf)) - 2816*w^2*sin(2*w*(t0 - tf)) - 1852*t0*w^3 + 1852*tf*w^3 - 4359*t0*tf^2*w^5 + 4359*t0^2*tf*w^5 + 975*t0*tf^4*w^7 - 975*t0^4*tf*w^7 - 2048*t0*w^3*cos(w*(t0 - tf)) + 3900*t0*w^3*cos(2*w*(t0 - tf)) + 2048*tf*w^3*cos(w*(t0 - tf)) - 3900*tf*w^3*cos(2*w*(t0 - tf)) - 1950*t0^2*tf^3*w^7 + 1950*t0^3*tf^2*w^7 + 552*t0^3*w^5*cos(w*(t0 - tf)) - 243*t0^3*w^5*cos(2*w*(t0 - tf)) - 552*tf^3*w^5*cos(w*(t0 - tf)) + 243*tf^3*w^5*cos(2*w*(t0 - tf)) + 2008*t0^2*w^4*sin(w*(t0 - tf)) + 1548*t0^2*w^4*sin(2*w*(t0 - tf)) + 210*t0^4*w^6*sin(w*(t0 - tf)) - (27*t0^4*w^6*sin(2*w*(t0 - tf)))/2 + 2008*tf^2*w^4*sin(w*(t0 - tf)) + 1548*tf^2*w^4*sin(2*w*(t0 - tf)) + 210*tf^4*w^6*sin(w*(t0 - tf)) - (27*tf^4*w^6*sin(2*w*(t0 - tf)))/2 - 4016*t0*tf*w^4*sin(w*(t0 - tf)) - 3096*t0*tf*w^4*sin(2*w*(t0 - tf)) + 1656*t0*tf^2*w^5*cos(w*(t0 - tf)) - 1656*t0^2*tf*w^5*cos(w*(t0 - tf)) - 729*t0*tf^2*w^5*cos(2*w*(t0 - tf)) + 729*t0^2*tf*w^5*cos(2*w*(t0 - tf)) - 840*t0*tf^3*w^6*sin(w*(t0 - tf)) - 840*t0^3*tf*w^6*sin(w*(t0 - tf)) + 54*t0*tf^3*w^6*sin(2*w*(t0 - tf)) + 54*t0^3*tf*w^6*sin(2*w*(t0 - tf)) + 1260*t0^2*tf^2*w^6*sin(w*(t0 - tf)) - 81*t0^2*tf^2*w^6*sin(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152); ...
	                                                   -(16*w*((1107*t0^4*w^5)/8 - (1385*t0^2*w^3)/2 - 384*w - (1385*tf^2*w^3)/2 + (1107*tf^4*w^5)/8 + 512*w*cos(w*(t0 - tf)) - 128*w*cos(2*w*(t0 - tf)) + 1385*t0*tf*w^3 - (1107*t0*tf^3*w^5)/2 - (1107*t0^3*tf*w^5)/2 + 1104*t0*w^2*sin(w*(t0 - tf)) - 552*t0*w^2*sin(2*w*(t0 - tf)) - 1104*tf*w^2*sin(w*(t0 - tf)) + 552*tf*w^2*sin(2*w*(t0 - tf)) + (3321*t0^2*tf^2*w^5)/4 + 400*t0^2*w^3*cos(w*(t0 - tf)) + (585*t0^2*w^3*cos(2*w*(t0 - tf)))/2 + 30*t0^4*w^5*cos(w*(t0 - tf)) - (27*t0^4*w^5*cos(2*w*(t0 - tf)))/8 + 400*tf^2*w^3*cos(w*(t0 - tf)) + (585*tf^2*w^3*cos(2*w*(t0 - tf)))/2 + 30*tf^4*w^5*cos(w*(t0 - tf)) - (27*tf^4*w^5*cos(2*w*(t0 - tf)))/8 + 24*t0^3*w^4*sin(w*(t0 - tf)) + 54*t0^3*w^4*sin(2*w*(t0 - tf)) - 24*tf^3*w^4*sin(w*(t0 - tf)) - 54*tf^3*w^4*sin(2*w*(t0 - tf)) - 120*t0*tf^3*w^5*cos(w*(t0 - tf)) - 120*t0^3*tf*w^5*cos(w*(t0 - tf)) + (27*t0*tf^3*w^5*cos(2*w*(t0 - tf)))/2 + (27*t0^3*tf*w^5*cos(2*w*(t0 - tf)))/2 + 72*t0*tf^2*w^4*sin(w*(t0 - tf)) - 72*t0^2*tf*w^4*sin(w*(t0 - tf)) + 162*t0*tf^2*w^4*sin(2*w*(t0 - tf)) - 162*t0^2*tf*w^4*sin(2*w*(t0 - tf)) + 180*t0^2*tf^2*w^5*cos(w*(t0 - tf)) - (81*t0^2*tf^2*w^5*cos(2*w*(t0 - tf)))/4 - 800*t0*tf*w^3*cos(w*(t0 - tf)) - 585*t0*tf*w^3*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),                                                                                                                                                                             -(4*(472*tf^3*w^4 - 15*t0^5*w^6 - 472*t0^3*w^4 + 15*tf^5*w^6 + 2084*t0*w^2 - 2084*tf*w^2 - 2432*w*sin(w*(t0 - tf)) + 1216*w*sin(2*w*(t0 - tf)) - 1416*t0*tf^2*w^4 + 1416*t0^2*tf*w^4 - 75*t0*tf^4*w^6 + 75*t0^4*tf*w^6 - 1664*t0*w^2*cos(w*(t0 - tf)) - 420*t0*w^2*cos(2*w*(t0 - tf)) + 1664*tf*w^2*cos(w*(t0 - tf)) + 420*tf*w^2*cos(2*w*(t0 - tf)) + 150*t0^2*tf^3*w^6 - 150*t0^3*tf^2*w^6 - 240*t0^3*w^4*cos(w*(t0 - tf)) - 48*t0^3*w^4*cos(2*w*(t0 - tf)) + 240*tf^3*w^4*cos(w*(t0 - tf)) + 48*tf^3*w^4*cos(2*w*(t0 - tf)) + 112*t0^2*w^3*sin(w*(t0 - tf)) + 96*t0^2*w^3*sin(2*w*(t0 - tf)) - (9*t0^4*w^5*sin(2*w*(t0 - tf)))/2 + 112*tf^2*w^3*sin(w*(t0 - tf)) + 96*tf^2*w^3*sin(2*w*(t0 - tf)) - (9*tf^4*w^5*sin(2*w*(t0 - tf)))/2 - 224*t0*tf*w^3*sin(w*(t0 - tf)) - 192*t0*tf*w^3*sin(2*w*(t0 - tf)) - 720*t0*tf^2*w^4*cos(w*(t0 - tf)) + 720*t0^2*tf*w^4*cos(w*(t0 - tf)) - 144*t0*tf^2*w^4*cos(2*w*(t0 - tf)) + 144*t0^2*tf*w^4*cos(2*w*(t0 - tf)) + 18*t0*tf^3*w^5*sin(2*w*(t0 - tf)) + 18*t0^3*tf*w^5*sin(2*w*(t0 - tf)) - 27*t0^2*tf^2*w^5*sin(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),                                                                                -(8*w*(80*t0^3*w^4 - 80*tf^3*w^4 - 241*t0*w^2 + 241*tf*w^2 + 352*w*sin(w*(t0 - tf)) - 176*w*sin(2*w*(t0 - tf)) + 240*t0*tf^2*w^4 - 240*t0^2*tf*w^4 + 160*t0*w^2*cos(w*(t0 - tf)) + 81*t0*w^2*cos(2*w*(t0 - tf)) - 160*tf*w^2*cos(w*(t0 - tf)) - 81*tf*w^2*cos(2*w*(t0 - tf)) + 30*t0^3*w^4*cos(w*(t0 - tf)) - 30*tf^3*w^4*cos(w*(t0 - tf)) - 62*t0^2*w^3*sin(w*(t0 - tf)) + 9*t0^2*w^3*sin(2*w*(t0 - tf)) - 62*tf^2*w^3*sin(w*(t0 - tf)) + 9*tf^2*w^3*sin(2*w*(t0 - tf)) + 124*t0*tf*w^3*sin(w*(t0 - tf)) - 18*t0*tf*w^3*sin(2*w*(t0 - tf)) + 90*t0*tf^2*w^4*cos(w*(t0 - tf)) - 90*t0^2*tf*w^4*cos(w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -(12*w^2*(t0 - tf)*(704*sin(w*(t0 - tf)) - 352*sin(2*w*(t0 - tf)) + 93*t0^3*w^3 - 93*tf^3*w^3 - 537*t0*w + 537*tf*w + 320*t0*w*cos(w*(t0 - tf)) + 217*t0*w*cos(2*w*(t0 - tf)) - 320*tf*w*cos(w*(t0 - tf)) - 217*tf*w*cos(2*w*(t0 - tf)) + 279*t0*tf^2*w^3 - 279*t0^2*tf*w^3 + 20*t0^3*w^3*cos(w*(t0 - tf)) - 3*t0^3*w^3*cos(2*w*(t0 - tf)) - 20*tf^3*w^3*cos(w*(t0 - tf)) + 3*tf^3*w^3*cos(2*w*(t0 - tf)) + 44*t0^2*w^2*sin(w*(t0 - tf)) + 44*t0^2*w^2*sin(2*w*(t0 - tf)) + 44*tf^2*w^2*sin(w*(t0 - tf)) + 44*tf^2*w^2*sin(2*w*(t0 - tf)) - 88*t0*tf*w^2*sin(w*(t0 - tf)) - 88*t0*tf*w^2*sin(2*w*(t0 - tf)) + 60*t0*tf^2*w^3*cos(w*(t0 - tf)) - 60*t0^2*tf*w^3*cos(w*(t0 - tf)) - 9*t0*tf^2*w^3*cos(2*w*(t0 - tf)) + 9*t0^2*tf*w^3*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152); ...
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (8*w*(75*t0^4*w^6 - (933*t0^2*w^4)/2 - (933*tf^2*w^4)/2 + 75*tf^4*w^6 - 1536*w^2*cos(w*(t0 - tf)) + 384*w^2*cos(2*w*(t0 - tf)) + 1152*w^2 + 933*t0*tf*w^4 - 300*t0*tf^3*w^6 - 300*t0^3*tf*w^6 - 288*t0*w^3*sin(w*(t0 - tf)) + 144*t0*w^3*sin(2*w*(t0 - tf)) + 288*tf*w^3*sin(w*(t0 - tf)) - 144*tf*w^3*sin(2*w*(t0 - tf)) + 450*t0^2*tf^2*w^6 + 480*t0^2*w^4*cos(w*(t0 - tf)) - (27*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 480*tf^2*w^4*cos(w*(t0 - tf)) - (27*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + 90*t0^3*w^5*sin(w*(t0 - tf)) - 90*tf^3*w^5*sin(w*(t0 - tf)) + 270*t0*tf^2*w^5*sin(w*(t0 - tf)) - 270*t0^2*tf*w^5*sin(w*(t0 - tf)) - 960*t0*tf*w^4*cos(w*(t0 - tf)) + 27*t0*tf*w^4*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -(8*(80*t0^3*w^5 - 80*tf^3*w^5 + 352*w^2*sin(w*(t0 - tf)) - 176*w^2*sin(2*w*(t0 - tf)) - 241*t0*w^3 + 241*tf*w^3 + 240*t0*tf^2*w^5 - 240*t0^2*tf*w^5 + 160*t0*w^3*cos(w*(t0 - tf)) + 81*t0*w^3*cos(2*w*(t0 - tf)) - 160*tf*w^3*cos(w*(t0 - tf)) - 81*tf*w^3*cos(2*w*(t0 - tf)) + 30*t0^3*w^5*cos(w*(t0 - tf)) - 30*tf^3*w^5*cos(w*(t0 - tf)) - 62*t0^2*w^4*sin(w*(t0 - tf)) + 9*t0^2*w^4*sin(2*w*(t0 - tf)) - 62*tf^2*w^4*sin(w*(t0 - tf)) + 9*tf^2*w^4*sin(2*w*(t0 - tf)) + 124*t0*tf*w^4*sin(w*(t0 - tf)) - 18*t0*tf*w^4*sin(2*w*(t0 - tf)) + 90*t0*tf^2*w^5*cos(w*(t0 - tf)) - 90*t0^2*tf*w^5*cos(w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),                                                                                                                                                                                                                                                                                                                                                                                                                                      (4*w^3*(96*sin(w*(t0 - tf)) - 48*sin(2*w*(t0 - tf)) + 50*t0^3*w^3 - 50*tf^3*w^3 - 169*t0*w + 169*tf*w + 160*t0*w*cos(w*(t0 - tf)) + 9*t0*w*cos(2*w*(t0 - tf)) - 160*tf*w*cos(w*(t0 - tf)) - 9*tf*w*cos(2*w*(t0 - tf)) + 150*t0*tf^2*w^3 - 150*t0^2*tf*w^3))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (4*(75*t0^4*w^6 - (1075*t0^2*w^4)/2 - (1075*tf^2*w^4)/2 + 75*tf^4*w^6 - 2048*w^2*cos(w*(t0 - tf)) + 512*w^2*cos(2*w*(t0 - tf)) + 1536*w^2 + 1075*t0*tf*w^4 - 300*t0*tf^3*w^6 - 300*t0^3*tf*w^6 - 432*t0*w^3*sin(w*(t0 - tf)) + 216*t0*w^3*sin(2*w*(t0 - tf)) + 432*tf*w^3*sin(w*(t0 - tf)) - 216*tf*w^3*sin(2*w*(t0 - tf)) + 450*t0^2*tf^2*w^6 + 560*t0^2*w^4*cos(w*(t0 - tf)) - (45*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 560*tf^2*w^4*cos(w*(t0 - tf)) - (45*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + 120*t0^3*w^5*sin(w*(t0 - tf)) - 120*tf^3*w^5*sin(w*(t0 - tf)) + 360*t0*tf^2*w^5*sin(w*(t0 - tf)) - 360*t0^2*tf*w^5*sin(w*(t0 - tf)) - 1120*t0*tf*w^4*cos(w*(t0 - tf)) + 45*t0*tf*w^4*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152); ...
	                      (8*w*(195*t0^5*w^6 - 1453*t0^3*w^4 + 1453*tf^3*w^4 - 195*tf^5*w^6 - 1852*t0*w^2 + 1852*tf*w^2 + 5632*w*sin(w*(t0 - tf)) - 2816*w*sin(2*w*(t0 - tf)) - 4359*t0*tf^2*w^4 + 4359*t0^2*tf*w^4 + 975*t0*tf^4*w^6 - 975*t0^4*tf*w^6 - 2048*t0*w^2*cos(w*(t0 - tf)) + 3900*t0*w^2*cos(2*w*(t0 - tf)) + 2048*tf*w^2*cos(w*(t0 - tf)) - 3900*tf*w^2*cos(2*w*(t0 - tf)) - 1950*t0^2*tf^3*w^6 + 1950*t0^3*tf^2*w^6 + 552*t0^3*w^4*cos(w*(t0 - tf)) - 243*t0^3*w^4*cos(2*w*(t0 - tf)) - 552*tf^3*w^4*cos(w*(t0 - tf)) + 243*tf^3*w^4*cos(2*w*(t0 - tf)) + 2008*t0^2*w^3*sin(w*(t0 - tf)) + 1548*t0^2*w^3*sin(2*w*(t0 - tf)) + 210*t0^4*w^5*sin(w*(t0 - tf)) - (27*t0^4*w^5*sin(2*w*(t0 - tf)))/2 + 2008*tf^2*w^3*sin(w*(t0 - tf)) + 1548*tf^2*w^3*sin(2*w*(t0 - tf)) + 210*tf^4*w^5*sin(w*(t0 - tf)) - (27*tf^4*w^5*sin(2*w*(t0 - tf)))/2 - 4016*t0*tf*w^3*sin(w*(t0 - tf)) - 3096*t0*tf*w^3*sin(2*w*(t0 - tf)) + 1656*t0*tf^2*w^4*cos(w*(t0 - tf)) - 1656*t0^2*tf*w^4*cos(w*(t0 - tf)) - 729*t0*tf^2*w^4*cos(2*w*(t0 - tf)) + 729*t0^2*tf*w^4*cos(2*w*(t0 - tf)) - 840*t0*tf^3*w^5*sin(w*(t0 - tf)) - 840*t0^3*tf*w^5*sin(w*(t0 - tf)) + 54*t0*tf^3*w^5*sin(2*w*(t0 - tf)) + 54*t0^3*tf*w^5*sin(2*w*(t0 - tf)) + 1260*t0^2*tf^2*w^5*sin(w*(t0 - tf)) - 81*t0^2*tf^2*w^5*sin(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -(12*w^2*(t0 - tf)*(704*sin(w*(t0 - tf)) - 352*sin(2*w*(t0 - tf)) + 93*t0^3*w^3 - 93*tf^3*w^3 - 537*t0*w + 537*tf*w + 320*t0*w*cos(w*(t0 - tf)) + 217*t0*w*cos(2*w*(t0 - tf)) - 320*tf*w*cos(w*(t0 - tf)) - 217*tf*w*cos(2*w*(t0 - tf)) + 279*t0*tf^2*w^3 - 279*t0^2*tf*w^3 + 20*t0^3*w^3*cos(w*(t0 - tf)) - 3*t0^3*w^3*cos(2*w*(t0 - tf)) - 20*tf^3*w^3*cos(w*(t0 - tf)) + 3*tf^3*w^3*cos(2*w*(t0 - tf)) + 44*t0^2*w^2*sin(w*(t0 - tf)) + 44*t0^2*w^2*sin(2*w*(t0 - tf)) + 44*tf^2*w^2*sin(w*(t0 - tf)) + 44*tf^2*w^2*sin(2*w*(t0 - tf)) - 88*t0*tf*w^2*sin(w*(t0 - tf)) - 88*t0*tf*w^2*sin(2*w*(t0 - tf)) + 60*t0*tf^2*w^3*cos(w*(t0 - tf)) - 60*t0^2*tf*w^3*cos(w*(t0 - tf)) - 9*t0*tf^2*w^3*cos(2*w*(t0 - tf)) + 9*t0^2*tf*w^3*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152), (4*w*(1536*w - (1075*t0^2*w^3)/2 + 75*t0^4*w^5 - (1075*tf^2*w^3)/2 + 75*tf^4*w^5 - 2048*w*cos(w*(t0 - tf)) + 512*w*cos(2*w*(t0 - tf)) + 1075*t0*tf*w^3 - 300*t0*tf^3*w^5 - 300*t0^3*tf*w^5 - 432*t0*w^2*sin(w*(t0 - tf)) + 216*t0*w^2*sin(2*w*(t0 - tf)) + 432*tf*w^2*sin(w*(t0 - tf)) - 216*tf*w^2*sin(2*w*(t0 - tf)) + 450*t0^2*tf^2*w^5 + 560*t0^2*w^3*cos(w*(t0 - tf)) - (45*t0^2*w^3*cos(2*w*(t0 - tf)))/2 + 560*tf^2*w^3*cos(w*(t0 - tf)) - (45*tf^2*w^3*cos(2*w*(t0 - tf)))/2 + 120*t0^3*w^4*sin(w*(t0 - tf)) - 120*tf^3*w^4*sin(w*(t0 - tf)) + 360*t0*tf^2*w^4*sin(w*(t0 - tf)) - 360*t0^2*tf*w^4*sin(w*(t0 - tf)) - 1120*t0*tf*w^3*cos(w*(t0 - tf)) + 45*t0*tf*w^3*cos(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152), (8*(105*t0^5*w^6 - (1619*t0^3*w^4)/2 + (1619*tf^3*w^4)/2 - 105*tf^5*w^6 - 1042*t0*w^2 + 1042*tf*w^2 + 3328*w*sin(w*(t0 - tf)) - 1664*w*sin(2*w*(t0 - tf)) - (4857*t0*tf^2*w^4)/2 + (4857*t0^2*tf*w^4)/2 + 525*t0*tf^4*w^6 - 525*t0^4*tf*w^6 - 1280*t0*w^2*cos(w*(t0 - tf)) + 2322*t0*w^2*cos(2*w*(t0 - tf)) + 1280*tf*w^2*cos(w*(t0 - tf)) - 2322*tf*w^2*cos(2*w*(t0 - tf)) - 1050*t0^2*tf^3*w^6 + 1050*t0^3*tf^2*w^6 + 288*t0^3*w^4*cos(w*(t0 - tf)) - (309*t0^3*w^4*cos(2*w*(t0 - tf)))/2 - 288*tf^3*w^4*cos(w*(t0 - tf)) + (309*tf^3*w^4*cos(2*w*(t0 - tf)))/2 + 1120*t0^2*w^3*sin(w*(t0 - tf)) + 948*t0^2*w^3*sin(2*w*(t0 - tf)) + 120*t0^4*w^5*sin(w*(t0 - tf)) - 9*t0^4*w^5*sin(2*w*(t0 - tf)) + 1120*tf^2*w^3*sin(w*(t0 - tf)) + 948*tf^2*w^3*sin(2*w*(t0 - tf)) + 120*tf^4*w^5*sin(w*(t0 - tf)) - 9*tf^4*w^5*sin(2*w*(t0 - tf)) - 2240*t0*tf*w^3*sin(w*(t0 - tf)) - 1896*t0*tf*w^3*sin(2*w*(t0 - tf)) + 864*t0*tf^2*w^4*cos(w*(t0 - tf)) - 864*t0^2*tf*w^4*cos(w*(t0 - tf)) - (927*t0*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + (927*t0^2*tf*w^4*cos(2*w*(t0 - tf)))/2 - 480*t0*tf^3*w^5*sin(w*(t0 - tf)) - 480*t0^3*tf*w^5*sin(w*(t0 - tf)) + 36*t0*tf^3*w^5*sin(2*w*(t0 - tf)) + 36*t0^3*tf*w^5*sin(2*w*(t0 - tf)) + 720*t0^2*tf^2*w^5*sin(w*(t0 - tf)) - 54*t0^2*tf^2*w^5*sin(2*w*(t0 - tf))))/(65536*cos(w*(t0 - tf)) - 16384*cos(2*w*(t0 - tf)) + 8336*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 16672*t0*tf*w^2 + 29184*t0*w*sin(w*(t0 - tf)) - 14592*t0*w*sin(2*w*(t0 - tf)) - 29184*tf*w*sin(w*(t0 - tf)) + 14592*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 12800*t0^2*w^2*cos(w*(t0 - tf)) + 4464*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 12800*tf^2*w^2*cos(w*(t0 - tf)) + 4464*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 7104*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 7104*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 21312*t0*tf^2*w^3*sin(w*(t0 - tf)) + 21312*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 25600*t0*tf*w^2*cos(w*(t0 - tf)) - 8928*t0*tf*w^2*cos(2*w*(t0 - tf)) - 49152)]
%}
% iW = subs(iW, t0, 0);
iW = [ -(4*w*(735*tf^5*w^7 - 5212*tf^3*w^5 - 6928*tf*w^3 + 18432*w^2*sin(tf*w) - 9216*w^2*sin(2*tf*w) - 5888*tf*w^3*cos(tf*w) + 12816*tf*w^3*cos(2*tf*w) + 2016*tf^3*w^5*cos(tf*w) - 756*tf^3*w^5*cos(2*tf*w) + 7488*tf^2*w^4*sin(tf*w) + 4968*tf^2*w^4*sin(2*tf*w) + 720*tf^4*w^6*sin(tf*w) - (81*tf^4*w^6*sin(2*tf*w))/2))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152), -(2214*tf^4*w^6 - 11080*tf^2*w^4 - 6144*w^2 + 8192*w^2*cos(tf*w) - 2048*w^2*cos(2*tf*w) + 17664*tf*w^3*sin(tf*w) - 8832*tf*w^3*sin(2*tf*w) + 6400*tf^2*w^4*cos(tf*w) + 4680*tf^2*w^4*cos(2*tf*w) + 480*tf^4*w^6*cos(tf*w) - 54*tf^4*w^6*cos(2*tf*w) + 384*tf^3*w^5*sin(tf*w) + 864*tf^3*w^5*sin(2*tf*w))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152), (8*w*(75*tf^4*w^6 - (933*tf^2*w^4)/2 + 1152*w^2 - 1536*w^2*cos(tf*w) + 384*w^2*cos(2*tf*w) - 288*tf*w^3*sin(tf*w) + 144*tf*w^3*sin(2*tf*w) + 480*tf^2*w^4*cos(tf*w) - (27*tf^2*w^4*cos(2*tf*w))/2 + 90*tf^3*w^5*sin(tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152), -(1560*tf^5*w^7 - 11624*tf^3*w^5 - 14816*tf*w^3 + 45056*w^2*sin(tf*w) - 22528*w^2*sin(2*tf*w) - 16384*tf*w^3*cos(tf*w) + 31200*tf*w^3*cos(2*tf*w) + 4416*tf^3*w^5*cos(tf*w) - 1944*tf^3*w^5*cos(2*tf*w) + 16064*tf^2*w^4*sin(tf*w) + 12384*tf^2*w^4*sin(2*tf*w) + 1680*tf^4*w^6*sin(tf*w) - 108*tf^4*w^6*sin(2*tf*w))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152); ...
	        -(16*w*((1107*tf^4*w^5)/8 - (1385*tf^2*w^3)/2 - 384*w + 512*w*cos(tf*w) - 128*w*cos(2*tf*w) + 1104*tf*w^2*sin(tf*w) - 552*tf*w^2*sin(2*tf*w) + 400*tf^2*w^3*cos(tf*w) + (585*tf^2*w^3*cos(2*tf*w))/2 + 30*tf^4*w^5*cos(tf*w) - (27*tf^4*w^5*cos(2*tf*w))/8 + 24*tf^3*w^4*sin(tf*w) + 54*tf^3*w^4*sin(2*tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),                                 -(1888*tf^3*w^4 + 60*tf^5*w^6 + 9728*w*sin(tf*w) - 4864*w*sin(2*tf*w) - 8336*tf*w^2 + 6656*tf*w^2*cos(tf*w) + 1680*tf*w^2*cos(2*tf*w) + 960*tf^3*w^4*cos(tf*w) + 192*tf^3*w^4*cos(2*tf*w) - 448*tf^2*w^3*sin(tf*w) - 384*tf^2*w^3*sin(2*tf*w) + 18*tf^4*w^5*sin(2*tf*w))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),                              (8*w*(80*tf^3*w^4 + 352*w*sin(tf*w) - 176*w*sin(2*tf*w) - 241*tf*w^2 + 160*tf*w^2*cos(tf*w) + 81*tf*w^2*cos(2*tf*w) + 30*tf^3*w^4*cos(tf*w) - 62*tf^2*w^3*sin(tf*w) + 9*tf^2*w^3*sin(2*tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),                                                                                                -(12*tf*w^2*(704*sin(tf*w) - 352*sin(2*tf*w) + 93*tf^3*w^3 - 537*tf*w + 20*tf^3*w^3*cos(tf*w) - 3*tf^3*w^3*cos(2*tf*w) + 44*tf^2*w^2*sin(tf*w) + 44*tf^2*w^2*sin(2*tf*w) + 320*tf*w*cos(tf*w) + 217*tf*w*cos(2*tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152); ...
	                                                                                           (8*w*(75*tf^4*w^6 - (933*tf^2*w^4)/2 + 1152*w^2 - 1536*w^2*cos(tf*w) + 384*w^2*cos(2*tf*w) - 288*tf*w^3*sin(tf*w) + 144*tf*w^3*sin(2*tf*w) + 480*tf^2*w^4*cos(tf*w) - (27*tf^2*w^4*cos(2*tf*w))/2 + 90*tf^3*w^5*sin(tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),                                                                                                    (640*tf^3*w^5 - 1928*tf*w^3 + 2816*w^2*sin(tf*w) - 1408*w^2*sin(2*tf*w) + 1280*tf*w^3*cos(tf*w) + 648*tf*w^3*cos(2*tf*w) + 240*tf^3*w^5*cos(tf*w) - 496*tf^2*w^4*sin(tf*w) + 72*tf^2*w^4*sin(2*tf*w))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),                                                                                                                 -(4*w^3*(96*sin(tf*w) - 48*sin(2*tf*w) + 50*tf^3*w^3 - 169*tf*w + 160*tf*w*cos(tf*w) + 9*tf*w*cos(2*tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),                                                                                                   (300*tf^4*w^6 - 2150*tf^2*w^4 + 6144*w^2 - 8192*w^2*cos(tf*w) + 2048*w^2*cos(2*tf*w) - 1728*tf*w^3*sin(tf*w) + 864*tf*w^3*sin(2*tf*w) + 2240*tf^2*w^4*cos(tf*w) - 90*tf^2*w^4*cos(2*tf*w) + 480*tf^3*w^5*sin(tf*w))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152); ...
	        -(8*w*(195*tf^5*w^6 - 1453*tf^3*w^4 + 5632*w*sin(tf*w) - 2816*w*sin(2*tf*w) - 1852*tf*w^2 - 2048*tf*w^2*cos(tf*w) + 3900*tf*w^2*cos(2*tf*w) + 552*tf^3*w^4*cos(tf*w) - 243*tf^3*w^4*cos(2*tf*w) + 2008*tf^2*w^3*sin(tf*w) + 1548*tf^2*w^3*sin(2*tf*w) + 210*tf^4*w^5*sin(tf*w) - (27*tf^4*w^5*sin(2*tf*w))/2))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),                                                                                   -(12*tf*w^2*(704*sin(tf*w) - 352*sin(2*tf*w) + 93*tf^3*w^3 - 537*tf*w + 20*tf^3*w^3*cos(tf*w) - 3*tf^3*w^3*cos(2*tf*w) + 44*tf^2*w^2*sin(tf*w) + 44*tf^2*w^2*sin(2*tf*w) + 320*tf*w*cos(tf*w) + 217*tf*w*cos(2*tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),     (4*w*(1536*w - (1075*tf^2*w^3)/2 + 75*tf^4*w^5 - 2048*w*cos(tf*w) + 512*w*cos(2*tf*w) - 432*tf*w^2*sin(tf*w) + 216*tf*w^2*sin(2*tf*w) + 560*tf^2*w^3*cos(tf*w) - (45*tf^2*w^3*cos(2*tf*w))/2 + 120*tf^3*w^4*sin(tf*w)))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152),            -(840*tf^5*w^6 - 6476*tf^3*w^4 + 26624*w*sin(tf*w) - 13312*w*sin(2*tf*w) - 8336*tf*w^2 - 10240*tf*w^2*cos(tf*w) + 18576*tf*w^2*cos(2*tf*w) + 2304*tf^3*w^4*cos(tf*w) - 1236*tf^3*w^4*cos(2*tf*w) + 8960*tf^2*w^3*sin(tf*w) + 7584*tf^2*w^3*sin(2*tf*w) + 960*tf^4*w^5*sin(tf*w) - 72*tf^4*w^5*sin(2*tf*w))/(65536*cos(tf*w) - 16384*cos(2*tf*w) + 8336*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 + 29184*tf*w*sin(tf*w) - 14592*tf*w*sin(2*tf*w) - 12800*tf^2*w^2*cos(tf*w) + 4464*tf^2*w^2*cos(2*tf*w) + 960*tf^4*w^4*cos(tf*w) - 27*tf^4*w^4*cos(2*tf*w) - 7104*tf^3*w^3*sin(tf*w) + 576*tf^3*w^3*sin(2*tf*w) - 49152)]

%{
iW = [ (4*w*(4335*t0^5*w^7 - 11476*t0^3*w^5 + 3772*tf^3*w^5 - 735*tf^5*w^7 + 4608*w^2*sin(w*(t0 - tf)) - 2304*w^2*sin(2*w*(t0 - tf)) - 28624*t0*w^3 + 976*tf*w^3 + 5316*t0*tf^2*w^5 + 2388*t0^2*tf*w^5 + 75*t0*tf^4*w^7 - 10875*t0^4*tf*w^7 + 32512*t0*w^3*cos(w*(t0 - tf)) - 3888*t0*w^3*cos(2*w*(t0 - tf)) + 4352*tf*w^3*cos(w*(t0 - tf)) - 5328*tf*w^3*cos(2*w*(t0 - tf)) - 150*t0^2*tf^3*w^7 + 7350*t0^3*tf^2*w^7 + 6336*t0^3*w^5*cos(w*(t0 - tf)) + 1188*t0^3*w^5*cos(2*w*(t0 - tf)) - 576*tf^3*w^5*cos(w*(t0 - tf)) + 756*tf^3*w^5*cos(2*w*(t0 - tf)) + 26976*t0^2*w^4*sin(w*(t0 - tf)) - 8424*t0^2*w^4*sin(2*w*(t0 - tf)) - 3600*t0^4*w^6*sin(w*(t0 - tf)) - (81*t0^4*w^6*sin(2*w*(t0 - tf)))/2 + 2784*tf^2*w^4*sin(w*(t0 - tf)) + 3672*tf^2*w^4*sin(2*w*(t0 - tf)) + 720*tf^4*w^6*sin(w*(t0 - tf)) - (81*tf^4*w^6*sin(2*w*(t0 - tf)))/2 - 15936*t0*tf*w^4*sin(w*(t0 - tf)) - 2160*t0*tf*w^4*sin(2*w*(t0 - tf)) - 15552*t0*tf^2*w^5*cos(w*(t0 - tf)) + 9792*t0^2*tf*w^5*cos(w*(t0 - tf)) - 1620*t0*tf^2*w^5*cos(2*w*(t0 - tf)) - 324*t0^2*tf*w^5*cos(2*w*(t0 - tf)) + 1440*t0*tf^3*w^6*sin(w*(t0 - tf)) + 10080*t0^3*tf*w^6*sin(w*(t0 - tf)) + 162*t0*tf^3*w^6*sin(2*w*(t0 - tf)) + 162*t0^3*tf*w^6*sin(2*w*(t0 - tf)) - 8640*t0^2*tf^2*w^6*sin(w*(t0 - tf)) - 243*t0^2*tf^2*w^6*sin(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288), (16*((887*t0^2*w^4)/2 - (867*t0^4*w^6)/8 - (421*tf^2*w^4)/2 + (93*tf^4*w^6)/8 - 1280*w^2*cos(w*(t0 - tf)) + 320*w^2*cos(2*w*(t0 - tf)) + 960*w^2 - 233*t0*tf*w^4 + (147*t0*tf^3*w^6)/2 + (627*t0^3*tf*w^6)/2 - 552*t0*w^3*sin(w*(t0 - tf)) + 276*t0*w^3*sin(2*w*(t0 - tf)) + 744*tf*w^3*sin(w*(t0 - tf)) - 372*tf*w^3*sin(2*w*(t0 - tf)) - (1161*t0^2*tf^2*w^6)/4 - 520*t0^2*w^4*cos(w*(t0 - tf)) + (153*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 150*t0^4*w^6*cos(w*(t0 - tf)) + (27*t0^4*w^6*cos(2*w*(t0 - tf)))/8 + 440*tf^2*w^4*cos(w*(t0 - tf)) - (459*tf^2*w^4*cos(2*w*(t0 - tf)))/2 - 30*tf^4*w^6*cos(w*(t0 - tf)) + (27*tf^4*w^6*cos(2*w*(t0 - tf)))/8 - 36*t0^3*w^5*sin(w*(t0 - tf)) - 96*tf^3*w^5*sin(w*(t0 - tf)) + 54*tf^3*w^5*sin(2*w*(t0 - tf)) - 60*t0*tf^3*w^6*cos(w*(t0 - tf)) - 420*t0^3*tf*w^6*cos(w*(t0 - tf)) - (27*t0*tf^3*w^6*cos(2*w*(t0 - tf)))/2 - (27*t0^3*tf*w^6*cos(2*w*(t0 - tf)))/2 + 156*t0*tf^2*w^5*sin(w*(t0 - tf)) - 24*t0^2*tf*w^5*sin(w*(t0 - tf)) - 108*t0*tf^2*w^5*sin(2*w*(t0 - tf)) + 54*t0^2*tf*w^5*sin(2*w*(t0 - tf)) + 360*t0^2*tf^2*w^6*cos(w*(t0 - tf)) + (81*t0^2*tf^2*w^6*cos(2*w*(t0 - tf)))/4 + 80*t0*tf*w^4*cos(w*(t0 - tf)) + 153*t0*tf*w^4*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288), -(8*w*((1335*t0^2*w^4)/2 - 225*t0^4*w^6 - (693*tf^2*w^4)/2 + 75*tf^4*w^6 - 768*w^2*cos(w*(t0 - tf)) + 192*w^2*cos(2*w*(t0 - tf)) + 576*w^2 - 321*t0*tf*w^4 + 600*t0^3*tf*w^6 - 792*t0*w^3*sin(w*(t0 - tf)) + 396*t0*w^3*sin(2*w*(t0 - tf)) + 216*tf*w^3*sin(w*(t0 - tf)) - 108*tf*w^3*sin(2*w*(t0 - tf)) - 450*t0^2*tf^2*w^6 - 600*t0^2*w^4*cos(w*(t0 - tf)) - (135*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 360*tf^2*w^4*cos(w*(t0 - tf)) - (27*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + 90*t0^3*w^5*sin(w*(t0 - tf)) - 90*tf^3*w^5*sin(w*(t0 - tf)) + 270*t0*tf^2*w^5*sin(w*(t0 - tf)) - 270*t0^2*tf*w^5*sin(w*(t0 - tf)) + 240*t0*tf*w^4*cos(w*(t0 - tf)) + 81*t0*tf*w^4*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),          (8*(1095*t0^5*w^7 - 2773*t0^3*w^5 + 1033*tf^3*w^5 - 195*tf^5*w^7 + 1408*w^2*sin(w*(t0 - tf)) - 704*w^2*sin(2*w*(t0 - tf)) - 8380*t0*w^3 + 316*tf*w^3 + 1245*t0*tf^2*w^5 + 495*t0^2*tf*w^5 + 75*t0*tf^4*w^7 - 2775*t0^4*tf*w^7 + 9472*t0*w^3*cos(w*(t0 - tf)) - 1092*t0*w^3*cos(2*w*(t0 - tf)) + 1280*tf*w^3*cos(w*(t0 - tf)) - 1596*tf*w^3*cos(2*w*(t0 - tf)) - 150*t0^2*tf^3*w^7 + 1950*t0^3*tf^2*w^7 + 1332*t0^3*w^5*cos(w*(t0 - tf)) + 297*t0^3*w^5*cos(2*w*(t0 - tf)) - 132*tf^3*w^5*cos(w*(t0 - tf)) + 243*tf^3*w^5*cos(2*w*(t0 - tf)) + 7492*t0^2*w^4*sin(w*(t0 - tf)) - 2250*t0^2*w^4*sin(2*w*(t0 - tf)) - 1050*t0^4*w^6*sin(w*(t0 - tf)) - (27*t0^4*w^6*sin(2*w*(t0 - tf)))/2 + 724*tf^2*w^4*sin(w*(t0 - tf)) + 1134*tf^2*w^4*sin(2*w*(t0 - tf)) + 210*tf^4*w^6*sin(w*(t0 - tf)) - (27*tf^4*w^6*sin(2*w*(t0 - tf)))/2 - 4760*t0*tf*w^4*sin(w*(t0 - tf)) - 612*t0*tf*w^4*sin(2*w*(t0 - tf)) - 4164*t0*tf^2*w^5*cos(w*(t0 - tf)) + 2964*t0^2*tf*w^5*cos(w*(t0 - tf)) - 513*t0*tf^2*w^5*cos(2*w*(t0 - tf)) - 27*t0^2*tf*w^5*cos(2*w*(t0 - tf)) + 420*t0*tf^3*w^6*sin(w*(t0 - tf)) + 2940*t0^3*tf*w^6*sin(w*(t0 - tf)) + 54*t0*tf^3*w^6*sin(2*w*(t0 - tf)) + 54*t0^3*tf*w^6*sin(2*w*(t0 - tf)) - 2520*t0^2*tf^2*w^6*sin(w*(t0 - tf)) - 81*t0^2*tf^2*w^6*sin(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288); ...
                                                                                              (16*w*(960*w + (887*t0^2*w^3)/2 - (867*t0^4*w^5)/8 - (421*tf^2*w^3)/2 + (93*tf^4*w^5)/8 - 1280*w*cos(w*(t0 - tf)) + 320*w*cos(2*w*(t0 - tf)) - 233*t0*tf*w^3 + (147*t0*tf^3*w^5)/2 + (627*t0^3*tf*w^5)/2 - 552*t0*w^2*sin(w*(t0 - tf)) + 276*t0*w^2*sin(2*w*(t0 - tf)) + 744*tf*w^2*sin(w*(t0 - tf)) - 372*tf*w^2*sin(2*w*(t0 - tf)) - (1161*t0^2*tf^2*w^5)/4 - 520*t0^2*w^3*cos(w*(t0 - tf)) + (153*t0^2*w^3*cos(2*w*(t0 - tf)))/2 + 150*t0^4*w^5*cos(w*(t0 - tf)) + (27*t0^4*w^5*cos(2*w*(t0 - tf)))/8 + 440*tf^2*w^3*cos(w*(t0 - tf)) - (459*tf^2*w^3*cos(2*w*(t0 - tf)))/2 - 30*tf^4*w^5*cos(w*(t0 - tf)) + (27*tf^4*w^5*cos(2*w*(t0 - tf)))/8 - 36*t0^3*w^4*sin(w*(t0 - tf)) - 96*tf^3*w^4*sin(w*(t0 - tf)) + 54*tf^3*w^4*sin(2*w*(t0 - tf)) - 60*t0*tf^3*w^5*cos(w*(t0 - tf)) - 420*t0^3*tf*w^5*cos(w*(t0 - tf)) - (27*t0*tf^3*w^5*cos(2*w*(t0 - tf)))/2 - (27*t0^3*tf*w^5*cos(2*w*(t0 - tf)))/2 + 156*t0*tf^2*w^4*sin(w*(t0 - tf)) - 24*t0^2*tf*w^4*sin(w*(t0 - tf)) - 108*t0*tf^2*w^4*sin(2*w*(t0 - tf)) + 54*t0^2*tf*w^4*sin(2*w*(t0 - tf)) + 360*t0^2*tf^2*w^5*cos(w*(t0 - tf)) + (81*t0^2*tf^2*w^5*cos(2*w*(t0 - tf)))/4 + 80*t0*tf*w^3*cos(w*(t0 - tf)) + 153*t0*tf*w^3*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),                                                                                                                                              (4*(15*t0^5*w^6 - 8*t0^3*w^4 + 8*tf^3*w^4 - 15*tf^5*w^6 - 452*t0*w^2 + 452*tf*w^2 - 640*w*sin(w*(t0 - tf)) + 320*w*sin(2*w*(t0 - tf)) - 24*t0*tf^2*w^4 + 24*t0^2*tf*w^4 + 75*t0*tf^4*w^6 - 75*t0^4*tf*w^6 + 896*t0*w^2*cos(w*(t0 - tf)) - 444*t0*w^2*cos(2*w*(t0 - tf)) - 896*tf*w^2*cos(w*(t0 - tf)) + 444*tf*w^2*cos(2*w*(t0 - tf)) - 150*t0^2*tf^3*w^6 + 150*t0^3*tf^2*w^6 - 240*t0^3*w^4*cos(w*(t0 - tf)) + 48*t0^3*w^4*cos(2*w*(t0 - tf)) + 240*tf^3*w^4*cos(w*(t0 - tf)) - 48*tf^3*w^4*cos(2*w*(t0 - tf)) + 368*t0^2*w^3*sin(w*(t0 - tf)) - 144*t0^2*w^3*sin(2*w*(t0 - tf)) + (9*t0^4*w^5*sin(2*w*(t0 - tf)))/2 + 368*tf^2*w^3*sin(w*(t0 - tf)) - 144*tf^2*w^3*sin(2*w*(t0 - tf)) + (9*tf^4*w^5*sin(2*w*(t0 - tf)))/2 - 736*t0*tf*w^3*sin(w*(t0 - tf)) + 288*t0*tf*w^3*sin(2*w*(t0 - tf)) - 720*t0*tf^2*w^4*cos(w*(t0 - tf)) + 720*t0^2*tf*w^4*cos(w*(t0 - tf)) + 144*t0*tf^2*w^4*cos(2*w*(t0 - tf)) - 144*t0^2*tf*w^4*cos(2*w*(t0 - tf)) - 18*t0*tf^3*w^5*sin(2*w*(t0 - tf)) - 18*t0^3*tf*w^5*sin(2*w*(t0 - tf)) + 27*t0^2*tf^2*w^5*sin(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),                                                -(16*w*(10*t0^3*w^4 - 10*tf^3*w^4 - (109*t0*w^2)/2 + (109*tf*w^2)/2 - 16*w*sin(w*(t0 - tf)) + 8*w*sin(2*w*(t0 - tf)) + 30*t0*tf^2*w^4 - 30*t0^2*tf*w^4 + 80*t0*w^2*cos(w*(t0 - tf)) - (51*t0*w^2*cos(2*w*(t0 - tf)))/2 - 80*tf*w^2*cos(w*(t0 - tf)) + (51*tf*w^2*cos(2*w*(t0 - tf)))/2 - 15*t0^3*w^4*cos(w*(t0 - tf)) + 15*tf^3*w^4*cos(w*(t0 - tf)) + 11*t0^2*w^3*sin(w*(t0 - tf)) - (9*t0^2*w^3*sin(2*w*(t0 - tf)))/2 + 11*tf^2*w^3*sin(w*(t0 - tf)) - (9*tf^2*w^3*sin(2*w*(t0 - tf)))/2 - 22*t0*tf*w^3*sin(w*(t0 - tf)) + 9*t0*tf*w^3*sin(2*w*(t0 - tf)) - 45*t0*tf^2*w^4*cos(w*(t0 - tf)) + 45*t0^2*tf*w^4*cos(w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),                                                                                                               (8*(1152*w + (861*t0^2*w^3)/2 - (219*t0^4*w^5)/2 - (447*tf^2*w^3)/2 + (21*tf^4*w^5)/2 - 1536*w*cos(w*(t0 - tf)) + 384*w*cos(2*w*(t0 - tf)) - 207*t0*tf*w^3 + 78*t0*tf^3*w^5 + 318*t0^3*tf*w^5 - 672*t0*w^2*sin(w*(t0 - tf)) + 336*t0*w^2*sin(2*w*(t0 - tf)) + 864*tf*w^2*sin(w*(t0 - tf)) - 432*tf*w^2*sin(2*w*(t0 - tf)) - 297*t0^2*tf^2*w^5 - 480*t0^2*w^3*cos(w*(t0 - tf)) + (99*t0^2*w^3*cos(2*w*(t0 - tf)))/2 + 150*t0^4*w^5*cos(w*(t0 - tf)) + (9*t0^4*w^5*cos(2*w*(t0 - tf)))/2 + 480*tf^2*w^3*cos(w*(t0 - tf)) - (513*tf^2*w^3*cos(2*w*(t0 - tf)))/2 - 30*tf^4*w^5*cos(w*(t0 - tf)) + (9*tf^4*w^5*cos(2*w*(t0 - tf)))/2 - 18*t0^3*w^4*sin(w*(t0 - tf)) - 12*t0^3*w^4*sin(2*w*(t0 - tf)) - 114*tf^3*w^4*sin(w*(t0 - tf)) + 66*tf^3*w^4*sin(2*w*(t0 - tf)) - 60*t0*tf^3*w^5*cos(w*(t0 - tf)) - 420*t0^3*tf*w^5*cos(w*(t0 - tf)) - 18*t0*tf^3*w^5*cos(2*w*(t0 - tf)) - 18*t0^3*tf*w^5*cos(2*w*(t0 - tf)) + 210*t0*tf^2*w^4*sin(w*(t0 - tf)) - 78*t0^2*tf*w^4*sin(w*(t0 - tf)) - 144*t0*tf^2*w^4*sin(2*w*(t0 - tf)) + 90*t0^2*tf*w^4*sin(2*w*(t0 - tf)) + 360*t0^2*tf^2*w^5*cos(w*(t0 - tf)) + 27*t0^2*tf^2*w^5*cos(2*w*(t0 - tf)) + 207*t0*tf*w^3*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288); ...
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -(8*w*((1335*t0^2*w^4)/2 - 225*t0^4*w^6 - (693*tf^2*w^4)/2 + 75*tf^4*w^6 - 768*w^2*cos(w*(t0 - tf)) + 192*w^2*cos(2*w*(t0 - tf)) + 576*w^2 - 321*t0*tf*w^4 + 600*t0^3*tf*w^6 - 792*t0*w^3*sin(w*(t0 - tf)) + 396*t0*w^3*sin(2*w*(t0 - tf)) + 216*tf*w^3*sin(w*(t0 - tf)) - 108*tf*w^3*sin(2*w*(t0 - tf)) - 450*t0^2*tf^2*w^6 - 600*t0^2*w^4*cos(w*(t0 - tf)) - (135*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 360*tf^2*w^4*cos(w*(t0 - tf)) - (27*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + 90*t0^3*w^5*sin(w*(t0 - tf)) - 90*tf^3*w^5*sin(w*(t0 - tf)) + 270*t0*tf^2*w^5*sin(w*(t0 - tf)) - 270*t0^2*tf*w^5*sin(w*(t0 - tf)) + 240*t0*tf*w^4*cos(w*(t0 - tf)) + 81*t0*tf*w^4*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          -(16*(10*t0^3*w^5 - 10*tf^3*w^5 - 16*w^2*sin(w*(t0 - tf)) + 8*w^2*sin(2*w*(t0 - tf)) - (109*t0*w^3)/2 + (109*tf*w^3)/2 + 30*t0*tf^2*w^5 - 30*t0^2*tf*w^5 + 80*t0*w^3*cos(w*(t0 - tf)) - (51*t0*w^3*cos(2*w*(t0 - tf)))/2 - 80*tf*w^3*cos(w*(t0 - tf)) + (51*tf*w^3*cos(2*w*(t0 - tf)))/2 - 15*t0^3*w^5*cos(w*(t0 - tf)) + 15*tf^3*w^5*cos(w*(t0 - tf)) + 11*t0^2*w^4*sin(w*(t0 - tf)) - (9*t0^2*w^4*sin(2*w*(t0 - tf)))/2 + 11*tf^2*w^4*sin(w*(t0 - tf)) - (9*tf^2*w^4*sin(2*w*(t0 - tf)))/2 - 22*t0*tf*w^4*sin(w*(t0 - tf)) + 9*t0*tf*w^4*sin(2*w*(t0 - tf)) - 45*t0*tf^2*w^5*cos(w*(t0 - tf)) + 45*t0^2*tf*w^5*cos(w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),                                                                                                                                                                                                                                                                                                                                                                                                                      (4*w^3*(96*sin(w*(t0 - tf)) - 48*sin(2*w*(t0 - tf)) + 50*t0^3*w^3 - 50*tf^3*w^3 - 169*t0*w + 169*tf*w + 160*t0*w*cos(w*(t0 - tf)) + 9*t0*w*cos(2*w*(t0 - tf)) - 160*tf*w*cos(w*(t0 - tf)) - 9*tf*w*cos(2*w*(t0 - tf)) + 150*t0*tf^2*w^3 - 150*t0^2*tf*w^3))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         -(4*((1273*t0^2*w^4)/2 - 225*t0^4*w^6 - (755*tf^2*w^4)/2 + 75*tf^4*w^6 - 1024*w^2*cos(w*(t0 - tf)) + 256*w^2*cos(2*w*(t0 - tf)) + 768*w^2 - 259*t0*tf*w^4 + 600*t0^3*tf*w^6 - 912*t0*w^3*sin(w*(t0 - tf)) + 456*t0*w^3*sin(2*w*(t0 - tf)) + 336*tf*w^3*sin(w*(t0 - tf)) - 168*tf*w^3*sin(2*w*(t0 - tf)) - 450*t0^2*tf^2*w^6 - 560*t0^2*w^4*cos(w*(t0 - tf)) - (153*t0^2*w^4*cos(2*w*(t0 - tf)))/2 + 400*tf^2*w^4*cos(w*(t0 - tf)) - (45*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + 120*t0^3*w^5*sin(w*(t0 - tf)) - 120*tf^3*w^5*sin(w*(t0 - tf)) + 360*t0*tf^2*w^5*sin(w*(t0 - tf)) - 360*t0^2*tf*w^5*sin(w*(t0 - tf)) + 160*t0*tf*w^4*cos(w*(t0 - tf)) + 99*t0*tf*w^4*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288); ...
                        (8*w*(1095*t0^5*w^6 - 2773*t0^3*w^4 + 1033*tf^3*w^4 - 195*tf^5*w^6 - 8380*t0*w^2 + 316*tf*w^2 + 1408*w*sin(w*(t0 - tf)) - 704*w*sin(2*w*(t0 - tf)) + 1245*t0*tf^2*w^4 + 495*t0^2*tf*w^4 + 75*t0*tf^4*w^6 - 2775*t0^4*tf*w^6 + 9472*t0*w^2*cos(w*(t0 - tf)) - 1092*t0*w^2*cos(2*w*(t0 - tf)) + 1280*tf*w^2*cos(w*(t0 - tf)) - 1596*tf*w^2*cos(2*w*(t0 - tf)) - 150*t0^2*tf^3*w^6 + 1950*t0^3*tf^2*w^6 + 1332*t0^3*w^4*cos(w*(t0 - tf)) + 297*t0^3*w^4*cos(2*w*(t0 - tf)) - 132*tf^3*w^4*cos(w*(t0 - tf)) + 243*tf^3*w^4*cos(2*w*(t0 - tf)) + 7492*t0^2*w^3*sin(w*(t0 - tf)) - 2250*t0^2*w^3*sin(2*w*(t0 - tf)) - 1050*t0^4*w^5*sin(w*(t0 - tf)) - (27*t0^4*w^5*sin(2*w*(t0 - tf)))/2 + 724*tf^2*w^3*sin(w*(t0 - tf)) + 1134*tf^2*w^3*sin(2*w*(t0 - tf)) + 210*tf^4*w^5*sin(w*(t0 - tf)) - (27*tf^4*w^5*sin(2*w*(t0 - tf)))/2 - 4760*t0*tf*w^3*sin(w*(t0 - tf)) - 612*t0*tf*w^3*sin(2*w*(t0 - tf)) - 4164*t0*tf^2*w^4*cos(w*(t0 - tf)) + 2964*t0^2*tf*w^4*cos(w*(t0 - tf)) - 513*t0*tf^2*w^4*cos(2*w*(t0 - tf)) - 27*t0^2*tf*w^4*cos(2*w*(t0 - tf)) + 420*t0*tf^3*w^5*sin(w*(t0 - tf)) + 2940*t0^3*tf*w^5*sin(w*(t0 - tf)) + 54*t0*tf^3*w^5*sin(2*w*(t0 - tf)) + 54*t0^3*tf*w^5*sin(2*w*(t0 - tf)) - 2520*t0^2*tf^2*w^5*sin(w*(t0 - tf)) - 81*t0^2*tf^2*w^5*sin(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),                                  (8*(1152*w + (861*t0^2*w^3)/2 - (219*t0^4*w^5)/2 - (447*tf^2*w^3)/2 + (21*tf^4*w^5)/2 - 1536*w*cos(w*(t0 - tf)) + 384*w*cos(2*w*(t0 - tf)) - 207*t0*tf*w^3 + 78*t0*tf^3*w^5 + 318*t0^3*tf*w^5 - 672*t0*w^2*sin(w*(t0 - tf)) + 336*t0*w^2*sin(2*w*(t0 - tf)) + 864*tf*w^2*sin(w*(t0 - tf)) - 432*tf*w^2*sin(2*w*(t0 - tf)) - 297*t0^2*tf^2*w^5 - 480*t0^2*w^3*cos(w*(t0 - tf)) + (99*t0^2*w^3*cos(2*w*(t0 - tf)))/2 + 150*t0^4*w^5*cos(w*(t0 - tf)) + (9*t0^4*w^5*cos(2*w*(t0 - tf)))/2 + 480*tf^2*w^3*cos(w*(t0 - tf)) - (513*tf^2*w^3*cos(2*w*(t0 - tf)))/2 - 30*tf^4*w^5*cos(w*(t0 - tf)) + (9*tf^4*w^5*cos(2*w*(t0 - tf)))/2 - 18*t0^3*w^4*sin(w*(t0 - tf)) - 12*t0^3*w^4*sin(2*w*(t0 - tf)) - 114*tf^3*w^4*sin(w*(t0 - tf)) + 66*tf^3*w^4*sin(2*w*(t0 - tf)) - 60*t0*tf^3*w^5*cos(w*(t0 - tf)) - 420*t0^3*tf*w^5*cos(w*(t0 - tf)) - 18*t0*tf^3*w^5*cos(2*w*(t0 - tf)) - 18*t0^3*tf*w^5*cos(2*w*(t0 - tf)) + 210*t0*tf^2*w^4*sin(w*(t0 - tf)) - 78*t0^2*tf*w^4*sin(w*(t0 - tf)) - 144*t0*tf^2*w^4*sin(2*w*(t0 - tf)) + 90*t0^2*tf*w^4*sin(2*w*(t0 - tf)) + 360*t0^2*tf^2*w^5*cos(w*(t0 - tf)) + 27*t0^2*tf^2*w^5*cos(2*w*(t0 - tf)) + 207*t0*tf*w^3*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288),    -(4*w*(768*w + (1273*t0^2*w^3)/2 - 225*t0^4*w^5 - (755*tf^2*w^3)/2 + 75*tf^4*w^5 - 1024*w*cos(w*(t0 - tf)) + 256*w*cos(2*w*(t0 - tf)) - 259*t0*tf*w^3 + 600*t0^3*tf*w^5 - 912*t0*w^2*sin(w*(t0 - tf)) + 456*t0*w^2*sin(2*w*(t0 - tf)) + 336*tf*w^2*sin(w*(t0 - tf)) - 168*tf*w^2*sin(2*w*(t0 - tf)) - 450*t0^2*tf^2*w^5 - 560*t0^2*w^3*cos(w*(t0 - tf)) - (153*t0^2*w^3*cos(2*w*(t0 - tf)))/2 + 400*tf^2*w^3*cos(w*(t0 - tf)) - (45*tf^2*w^3*cos(2*w*(t0 - tf)))/2 + 120*t0^3*w^4*sin(w*(t0 - tf)) - 120*tf^3*w^4*sin(w*(t0 - tf)) + 360*t0*tf^2*w^4*sin(w*(t0 - tf)) - 360*t0^2*tf*w^4*sin(w*(t0 - tf)) + 160*t0*tf*w^3*cos(w*(t0 - tf)) + 99*t0*tf*w^3*cos(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288), (8*(555*t0^5*w^6 - (2693*t0^3*w^4)/2 + (1139*tf^3*w^4)/2 - 105*tf^5*w^6 - 4834*t0*w^2 + 226*tf*w^2 + 832*w*sin(w*(t0 - tf)) - 416*w*sin(2*w*(t0 - tf)) + (1113*t0*tf^2*w^4)/2 + (441*t0^2*tf*w^4)/2 + 75*t0*tf^4*w^6 - 1425*t0^4*tf*w^6 + 5440*t0*w^2*cos(w*(t0 - tf)) - 606*t0*w^2*cos(2*w*(t0 - tf)) + 704*tf*w^2*cos(w*(t0 - tf)) - 930*tf*w^2*cos(2*w*(t0 - tf)) - 150*t0^2*tf^3*w^6 + 1050*t0^3*tf^2*w^6 + 528*t0^3*w^4*cos(w*(t0 - tf)) + (285*t0^3*w^4*cos(2*w*(t0 - tf)))/2 - 48*tf^3*w^4*cos(w*(t0 - tf)) + (309*tf^3*w^4*cos(2*w*(t0 - tf)))/2 + 4144*t0^2*w^3*sin(w*(t0 - tf)) - 1188*t0^2*w^3*sin(2*w*(t0 - tf)) - 600*t0^4*w^5*sin(w*(t0 - tf)) - 9*t0^4*w^5*sin(2*w*(t0 - tf)) + 400*tf^2*w^3*sin(w*(t0 - tf)) + 684*tf^2*w^3*sin(2*w*(t0 - tf)) + 120*tf^4*w^5*sin(w*(t0 - tf)) - 9*tf^4*w^5*sin(2*w*(t0 - tf)) - 2816*t0*tf*w^3*sin(w*(t0 - tf)) - 360*t0*tf*w^3*sin(2*w*(t0 - tf)) - 2256*t0*tf^2*w^4*cos(w*(t0 - tf)) + 1776*t0^2*tf*w^4*cos(w*(t0 - tf)) - (657*t0*tf^2*w^4*cos(2*w*(t0 - tf)))/2 + (63*t0^2*tf*w^4*cos(2*w*(t0 - tf)))/2 + 240*t0*tf^3*w^5*sin(w*(t0 - tf)) + 1680*t0^3*tf*w^5*sin(w*(t0 - tf)) + 36*t0*tf^3*w^5*sin(2*w*(t0 - tf)) + 36*t0^3*tf*w^5*sin(2*w*(t0 - tf)) - 1440*t0^2*tf^2*w^5*sin(w*(t0 - tf)) - 54*t0^2*tf^2*w^5*sin(2*w*(t0 - tf))))/(16384*cos(w*(t0 - tf)) - 4096*cos(2*w*(t0 - tf)) + 1808*t0^2*w^2 + 1147*t0^4*w^4 - 150*t0^6*w^6 + 1808*tf^2*w^2 + 1147*tf^4*w^4 - 150*tf^6*w^6 - 3616*t0*tf*w^2 + 12288*t0*w*sin(w*(t0 - tf)) - 6144*t0*w*sin(2*w*(t0 - tf)) - 12288*tf*w*sin(w*(t0 - tf)) + 6144*tf*w*sin(2*w*(t0 - tf)) - 4588*t0*tf^3*w^4 - 4588*t0^3*tf*w^4 + 900*t0*tf^5*w^6 + 900*t0^5*tf*w^6 + 6882*t0^2*tf^2*w^4 - 2250*t0^2*tf^4*w^6 + 3000*t0^3*tf^3*w^6 - 2250*t0^4*tf^2*w^6 - 5120*t0^2*w^2*cos(w*(t0 - tf)) + 3312*t0^2*w^2*cos(2*w*(t0 - tf)) + 960*t0^4*w^4*cos(w*(t0 - tf)) - 27*t0^4*w^4*cos(2*w*(t0 - tf)) - 5120*tf^2*w^2*cos(w*(t0 - tf)) + 3312*tf^2*w^2*cos(2*w*(t0 - tf)) + 960*tf^4*w^4*cos(w*(t0 - tf)) - 27*tf^4*w^4*cos(2*w*(t0 - tf)) - 3264*t0^3*w^3*sin(w*(t0 - tf)) + 576*t0^3*w^3*sin(2*w*(t0 - tf)) + 3264*tf^3*w^3*sin(w*(t0 - tf)) - 576*tf^3*w^3*sin(2*w*(t0 - tf)) - 3840*t0*tf^3*w^4*cos(w*(t0 - tf)) - 3840*t0^3*tf*w^4*cos(w*(t0 - tf)) + 108*t0*tf^3*w^4*cos(2*w*(t0 - tf)) + 108*t0^3*tf*w^4*cos(2*w*(t0 - tf)) - 9792*t0*tf^2*w^3*sin(w*(t0 - tf)) + 9792*t0^2*tf*w^3*sin(w*(t0 - tf)) + 1728*t0*tf^2*w^3*sin(2*w*(t0 - tf)) - 1728*t0^2*tf*w^3*sin(2*w*(t0 - tf)) + 5760*t0^2*tf^2*w^4*cos(w*(t0 - tf)) - 162*t0^2*tf^2*w^4*cos(2*w*(t0 - tf)) + 10240*t0*tf*w^2*cos(w*(t0 - tf)) - 6624*t0*tf*w^2*cos(2*w*(t0 - tf)) - 12288)];	

modSTMT = subs(STM, t, 0);
modSTMT = subs(modSTMT, tau, t);
modSTMT = transpose(modSTMT);
modSTM = subs(STM, t, 0);
modSTM = subs(modSTM, tau, tf);
u = transpose(B) * modSTMT * iW * (modSTM * xf - x0)
u = simplify(u)
% from here, hand u over to maple for integration
% J = int(uNormSqu, t, [0,tf])
J = 0.300e3 * ((tf * w - 2 * theta) ^ 2) * (w ^ 3) * (0.9e1 / 0.25e2 * tf * w * (tf ^ 2 * w ^ 2 - 80) * cos((tf * w)) ^ 2 - 0.48e2 / 0.5e1 * ((tf * w) - 0.8e1 / 0.3e1) * ((tf * w) + 0.8e1 / 0.3e1) * ((tf * w) - 0.3e1 / 0.5e1 * sin((tf * w))) * cos((tf * w)) + (tf ^ 5 * w ^ 5) - 0.347e3 / 0.75e2 * (tf ^ 3) * (w ^ 3) - 0.1136e4 / 0.25e2 * sin((tf * w)) * (tf ^ 2) * (w ^ 2) - 0.592e3 / 0.15e2 * tf * w + 0.1024e4 / 0.25e2 * sin((tf * w))) / ((81 * tf ^ 6 * w ^ 6 + 7776 * tf ^ 4 * w ^ 4 + 223488 * tf ^ 2 * w ^ 2 + 1048576) * cos((tf * w)) ^ 2 + (-4320 * tf ^ 6 * w ^ 6 + 49152 * tf ^ 4 * w ^ 4 + 163840 * tf ^ 2 * w ^ 2 - 2097152) * cos((tf * w)) + (225 * tf ^ 8 * w ^ 8) - (2001 * tf ^ 6 * w ^ 6) - (13664 * tf ^ 4 * w ^ 4) - (387328 * tf ^ 2 * w ^ 2) + 0.1048576e7);

tfRange = .1:1e-2:2;
J = subs(J, w, 1/(2*pi));
Jpos = subs(J, theta, pi/10);
Jneg = subs(J, theta, -pi/10);
JRangePos = subs(Jpos, tf, tfRange);
JRangeNeg = subs(Jneg, tf, tfRange);
figure;
plot(tfRange, JRangePos);
figure;
plot(tfRange, JRangeNeg);

% *** start part (f) ***
% https://en.wikipedia.org/wiki/State_observer#Continuous-time_case

% coeffs = [1    4    5.5    5    1.5625];
syms l1 l2 l3 l4;
% l = [0,0,0,0];
syms lambda;
% lambda^4+(l(3)+l(1))*lambda^3+(4*pi^2*l(2)+4*pi^2*l(4)+1)*lambda^2/(4*pi^2)-(4*pi*l(2)-4*pi*l(4)-4*l(1)-l(3))*lambda/(4*pi^2)-(3*(pi*l(4)+l(1)))/(4*pi^3)
% equ = [4 == l3+l1, 5.5 == 4*pi^2*l2+4*pi^2*l4+1/(4*pi^2), 5 == (4*pi*l2-4*pi*l4-4*l1-l3)/(4*pi^2), 1.5625 == (3*(pi*l4+l1))/(4*pi^3)];
% [A,B] = equationsToMatrix(equ, [l1 l2 l3 l4]);
% linsolve(A,B);
% lsol = solve(equ, [l1 l2 l3 l4]);
% solve did not work, vpa on linsolve produced below
lsol = [143.28414490727630953740295837251;  25.185759025391360722346616964373; -139.28414490727630953740295837251; -25.047084021774064048782533098738];

syms xhatdot xhat x1 x2 x3 x4 u1 u2;
% as defined by Chen pg. 249
xhatdot = (A - lsol * C) * xhat + B * [u1; u2] + lsol * C * [x1; x2; x3; x4]